<?xml version="1.0" encoding="utf-8"?>
<?xml-stylesheet type="text/xsl" href="../assets/xml/rss.xsl" media="all"?><rss xmlns:atom="http://www.w3.org/2005/Atom" version="2.0" xmlns:dc="http://purl.org/dc/elements/1.1/"><channel><title>Curious Efficiency (python)</title><link>http://www.curiousefficiency.org</link><description></description><atom:link href="http://www.curiousefficiency.org/categories/python.xml" type="application/rss+xml" rel="self"></atom:link><language>en</language><lastBuildDate>Mon, 09 Oct 2017 10:47:32 GMT</lastBuildDate><generator>https://getnikola.com/</generator><docs>http://blogs.law.harvard.edu/tech/rss</docs><item><title>Considering Python's Target Audience</title><link>http://www.curiousefficiency.org/posts/2017/10/considering-pythons-target-audience.html</link><dc:creator>Nick Coghlan</dc:creator><description>&lt;div&gt;&lt;div class="contents topic" id="who-is-python-being-designed-for"&gt;
&lt;p class="topic-title first"&gt;Who is Python being designed for?&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference internal" href="http://www.curiousefficiency.org/posts/2017/10/considering-pythons-target-audience.html#use-cases-for-python-s-reference-interpreter" id="id1"&gt;Use cases for Python's reference interpreter&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="http://www.curiousefficiency.org/posts/2017/10/considering-pythons-target-audience.html#which-audience-does-cpython-primarily-serve" id="id2"&gt;Which audience does CPython primarily serve?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="http://www.curiousefficiency.org/posts/2017/10/considering-pythons-target-audience.html#why-is-this-relevant-to-anything" id="id3"&gt;Why is this relevant to anything?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="http://www.curiousefficiency.org/posts/2017/10/considering-pythons-target-audience.html#where-does-pypi-fit-into-the-picture" id="id4"&gt;Where does PyPI fit into the picture?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="http://www.curiousefficiency.org/posts/2017/10/considering-pythons-target-audience.html#why-are-some-apis-changed-when-adding-them-to-the-standard-library" id="id5"&gt;Why are some APIs changed when adding them to the standard library?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="http://www.curiousefficiency.org/posts/2017/10/considering-pythons-target-audience.html#why-are-some-apis-added-in-provisional-form" id="id6"&gt;Why are some APIs added in provisional form?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="http://www.curiousefficiency.org/posts/2017/10/considering-pythons-target-audience.html#why-are-only-some-standard-library-apis-upgraded" id="id7"&gt;Why are only some standard library APIs upgraded?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="http://www.curiousefficiency.org/posts/2017/10/considering-pythons-target-audience.html#will-any-parts-of-the-standard-library-ever-be-independently-versioned" id="id8"&gt;Will any parts of the standard library ever be independently versioned?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="http://www.curiousefficiency.org/posts/2017/10/considering-pythons-target-audience.html#why-do-these-considerations-matter" id="id9"&gt;Why do these considerations matter?&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;p&gt;Several years ago, I
&lt;a class="reference external" href="http://www.curiousefficiency.org/posts/2011/04/musings-on-culture-of-python-dev.html"&gt;highlighted&lt;/a&gt;
"CPython moves both too fast and too slowly" as one of the more common causes
of conflict both within the python-dev mailing list, as well as between the
active CPython core developers and folks that decide that participating in
that process wouldn't be an effective use of their personal time and energy.&lt;/p&gt;
&lt;p&gt;I still consider that to be the case, but it's also a point I've spent a lot
of time reflecting on in the intervening years, as I wrote that original article
while I was still working for Boeing Defence Australia. The following month,
I left Boeing for Red Hat Asia-Pacific, and started gaining a redistributor
level perspective on
&lt;a class="reference external" href="http://community.redhat.com/blog/2015/02/the-quid-pro-quo-of-open-infrastructure/"&gt;open source supply chain management&lt;/a&gt;
in large enterprises.&lt;/p&gt;
&lt;div class="section" id="use-cases-for-python-s-reference-interpreter"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="http://www.curiousefficiency.org/posts/2017/10/considering-pythons-target-audience.html#id1"&gt;Use cases for Python's reference interpreter&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;While it's a gross oversimplification, I tend to break down CPython's use cases
as follows (note that these categories aren't fully distinct, they're just
aimed at focusing my thinking on different factors influencing the rollout of
new software features and versions):&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Education: educator's main interest is in teaching ways of modelling and
manipulating the world computationally, &lt;em&gt;not&lt;/em&gt; writing or maintaining
production software). Examples:&lt;ul&gt;
&lt;li&gt;Australia's &lt;a class="reference external" href="https://aca.edu.au/#home-unpack"&gt;Digital Curriculum&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Lorena A. Barba's &lt;a class="reference external" href="https://github.com/barbagroup/AeroPython"&gt;AeroPython&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Personal automation &amp;amp; hobby projects: software where the main, and often only,
user is the individual that wrote it. Examples:&lt;ul&gt;
&lt;li&gt;my Digital Blasphemy
&lt;a class="reference external" href="https://nbviewer.jupyter.org/urls/bitbucket.org/ncoghlan/misc/raw/default/notebooks/Digital%20Blasphemy.ipynb"&gt;image download notebook&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Paul Fenwick's (Inter)National &lt;a class="reference external" href="https://github.com/pjf/rickastley"&gt;Rick Astley Hotline&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Organisational process automation: software where the main, and often only,
user is the organisation it was originally written to benefit. Examples:&lt;ul&gt;
&lt;li&gt;CPython's &lt;a class="reference external" href="https://github.com/python/core-workflow"&gt;core workflow tools&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;Development, build &amp;amp; release management tooling for Linux distros&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Set-and-forget infrastructure: software where, for sometimes debatable
reasons, in-life upgrades to the software itself are nigh impossible, but
upgrades to the underlying platform may be feasible. Examples:&lt;ul&gt;
&lt;li&gt;most self-managed corporate and institutional infrastructure (where properly
funded sustaining engineering plans are disturbingly rare)&lt;/li&gt;
&lt;li&gt;grant funded software (where maintenance typically ends when the initial
grant runs out)&lt;/li&gt;
&lt;li&gt;software with strict certification requirements (where recertification is
too expensive for routine updates to be economically viable unless
absolutely essential)&lt;/li&gt;
&lt;li&gt;Embedded software systems without auto-upgrade capabilities&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Continuously upgraded infrastructure: software with a robust sustaining
engineering model, where dependency and platform upgrades are considered
routine, and no more concerning than any other code change. Examples:&lt;ul&gt;
&lt;li&gt;Facebook's Python service infrastructure&lt;/li&gt;
&lt;li&gt;Rolling release Linux distributions&lt;/li&gt;
&lt;li&gt;most public PaaS and serverless environments (Heroku, OpenShift, AWS Lambda,
Google Cloud Functions, Azure Cloud Functions, etc)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Intermittently upgraded standard operating environments: environments that do
carry out routine upgrades to their core components, but those upgrades occur
on a cycle measured in years, rather than weeks or months. Examples:&lt;ul&gt;
&lt;li&gt;&lt;a class="reference external" href="http://www.vfxplatform.com/"&gt;VFX Platform&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;LTS Linux distributions&lt;/li&gt;
&lt;li&gt;CPython and the Python standard library&lt;/li&gt;
&lt;li&gt;Infrastructure management &amp;amp; orchestration tools (e.g. OpenStack, Ansible)&lt;/li&gt;
&lt;li&gt;Hardware control systems&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Ephemeral software: software that tends to be used once and then discarded
or ignored, rather than being subsequently upgraded in place. Examples:&lt;ul&gt;
&lt;li&gt;Ad hoc automation scripts&lt;/li&gt;
&lt;li&gt;Single-player games with a defined "end" (once you've finished them, even
if you forget to uninstall them, you probably won't reinstall them on a new
device)&lt;/li&gt;
&lt;li&gt;Single-player games with little or no persistent state (if you uninstall and
reinstall them, it doesn't change much about your play experience)&lt;/li&gt;
&lt;li&gt;Event-specific applications (the application was tied to a specific physical
event, and once the event is over, that app doesn't matter any more)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Regular use applications: software that tends to be regularly upgraded after
deployment. Examples:&lt;ul&gt;
&lt;li&gt;Business management software&lt;/li&gt;
&lt;li&gt;Personal &amp;amp; professional productivity applications (e.g. Blender)&lt;/li&gt;
&lt;li&gt;Developer tools &amp;amp; services (e.g. Mercurial, Buildbot, Roundup)&lt;/li&gt;
&lt;li&gt;Multi-player games, and other games with significant persistent state, but
no real defined "end"&lt;/li&gt;
&lt;li&gt;Embedded software systems with auto-upgrade capabilities&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Shared abstraction layers: software components that are designed to make it
possible to work effectively in a particular problem domain even if you don't
personally grasp all the intricacies of that domain yet. Examples:&lt;ul&gt;
&lt;li&gt;most runtime libraries and frameworks fall into this category (e.g. Django,
Flask, Pyramid, SQL Alchemy, NumPy, SciPy, requests)&lt;/li&gt;
&lt;li&gt;many testing and type inference tools also fit here (e.g. pytest,
Hypothesis, vcrpy, behave, mypy)&lt;/li&gt;
&lt;li&gt;plugins for other applications (e.g. Blender plugins, OpenStack hardware
adapters)&lt;/li&gt;
&lt;li&gt;the standard library itself represents the baseline "world according to
Python" (and that's an
&lt;a class="reference external" href="http://www.curiousefficiency.org/posts/2015/10/languages-to-improve-your-python.html#broadening-our-horizons"&gt;incredibly complex&lt;/a&gt;
world view)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="which-audience-does-cpython-primarily-serve"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="http://www.curiousefficiency.org/posts/2017/10/considering-pythons-target-audience.html#id2"&gt;Which audience does CPython primarily serve?&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Ultimately, the main audiences that CPython and the standard library specifically
serve are those that, for whatever reason, aren't adequately served by the
combination of a more limited standard library and the installation of
explicitly declared third party dependencies from PyPI.&lt;/p&gt;
&lt;p&gt;To oversimplify the above review of different usage and deployment models even
further, it's possible to summarise the single largest split in Python's user
base as the one between those that are using Python as a &lt;em&gt;scripting language&lt;/em&gt;
for some environment of interest, and those that are using it as an &lt;em&gt;application
development language&lt;/em&gt;, where the eventual artifact that will be distributed is
something other than the script that they're working on.&lt;/p&gt;
&lt;p&gt;Typical developer behaviours when using Python as a scripting language include:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;the main working unit consists of a single Python file (or Jupyter notebook!),
rather than a directory of Python and metadata files&lt;/li&gt;
&lt;li&gt;there's no separate build step of any kind - the script is distributed &lt;em&gt;as&lt;/em&gt; a
script, similar to the way standalone shell scripts are distributed&lt;/li&gt;
&lt;li&gt;there's no separate install step (other than downloading the file to an
appropriate location), as it is expected that the required runtime environment
will be preconfigured on the destination system&lt;/li&gt;
&lt;li&gt;no explicit dependencies stated, except perhaps a minimum Python version,
or else a statement of the expected execution environment. If dependencies
outside the standard library are needed, they're expected to be provided by
the environment being scripted (whether that's an operating system,
a data analysis platform, or an application that embeds a Python runtime)&lt;/li&gt;
&lt;li&gt;no separate test suite, with the main test of correctness being "Did the
script do what you wanted it to do with the input that you gave it?"&lt;/li&gt;
&lt;li&gt;if testing prior to live execution is needed, it will be in the form of a
"dry run" or "preview" mode that conveys to the user what the software &lt;em&gt;would&lt;/em&gt;
do if run that way&lt;/li&gt;
&lt;li&gt;if static code analysis tools are used at all, it's via integration into the
user's software development environment, rather than being set up separately
for each individual script&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;By contrast, typical developer behaviours when using Python as an application
development language include:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;the main working unit consists of a directory of Python and metadata files,
rather than a single Python file&lt;/li&gt;
&lt;li&gt;these is a separate build step to prepare the application for publication,
even if it's just bundling the files together into a Python sdist, wheel
or zipapp archive&lt;/li&gt;
&lt;li&gt;whether there's a separate install step to prepare the application for use
will depend on how the application is packaged, and what the supported target
environments are&lt;/li&gt;
&lt;li&gt;external dependencies are expressed in a metadata file, either directly in
the project directory (e.g. &lt;tt class="docutils literal"&gt;pyproject.toml&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;requirements.txt&lt;/tt&gt;,
&lt;tt class="docutils literal"&gt;Pipfile&lt;/tt&gt;), or as part of the generated publication archive (e.g.
&lt;tt class="docutils literal"&gt;setup.py&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;flit.ini&lt;/tt&gt;)&lt;/li&gt;
&lt;li&gt;a separate test suite exists, either as unit tests for the Python API,
integration tests for the functional interfaces, or a combination of the two&lt;/li&gt;
&lt;li&gt;usage of static analysis tools is configured at the project level as part of
its testing regime, rather than being dependent on&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;As a result of that split, the main purpose that CPython and the standard
library end up serving is to define the redistributor independent baseline
of assumed functionality for educational and ad hoc Python scripting
environments 3-5 years after the corresponding CPython feature release.&lt;/p&gt;
&lt;p&gt;For ad hoc scripting use cases, that 3-5 year latency stems from a combination
of delays in redistributors making new releases available to their users, and
users of those redistributed versions taking time to revise their standard
operating environments.&lt;/p&gt;
&lt;p&gt;In the case of educational environments, educators need that kind of time to
review the new features and decide whether or not to incorporate them into the
courses they offer their students.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="why-is-this-relevant-to-anything"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="http://www.curiousefficiency.org/posts/2017/10/considering-pythons-target-audience.html#id3"&gt;Why is this relevant to anything?&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;This post was largely inspired by the Twitter discussion following on from
&lt;a class="reference external" href="https://twitter.com/ncoghlan_dev/status/916994106819088384"&gt;this comment of mine&lt;/a&gt;
citing the Provisional API status defined in
&lt;a class="reference external" href="https://www.python.org/dev/peps/pep-0411/"&gt;PEP 411&lt;/a&gt; as an example of an
open source project issuing a de facto invitation to users to participate more
actively in the design &amp;amp; development process as co-creators, rather than only
passively consuming already final designs.&lt;/p&gt;
&lt;p&gt;The responses included several expressions of frustration regarding the difficulty
of supporting provisional APIs in higher level libraries, without those libraries
making the provisional status transitive, and hence limiting support for any
related features to only the latest version of the provisional API, and not any
of the earlier iterations.&lt;/p&gt;
&lt;p&gt;My &lt;a class="reference external" href="https://twitter.com/ncoghlan_dev/status/917092464355241984"&gt;main reaction&lt;/a&gt;
was to suggest that open source publishers should impose whatever support
limitations they need to impose to make their ongoing maintenance efforts
personally sustainable. That means that if supporting older iterations of
provisional APIs is a pain, then they should only be supported if the project
developers themselves need that, or if somebody is paying them for the
inconvenience. This is similar to my view on whether or not volunteer-driven
projects should support older commercial LTS Python releases for free when it's
a hassle for them to do: I &lt;a class="reference external" href="http://www.curiousefficiency.org/posts/2015/04/stop-supporting-python26.html"&gt;don't think they should&lt;/a&gt;,
as I expect most such demands to be stemming from poorly managed institutional
inertia, rather than from genuine need (and if the need &lt;em&gt;is&lt;/em&gt; genuine, then it
should instead be possible to find some means of paying to have it addressed).&lt;/p&gt;
&lt;p&gt;However, my &lt;a class="reference external" href="https://twitter.com/ncoghlan_dev/status/917088410162012160"&gt;second reaction&lt;/a&gt;,
was to realise that even though I've touched on this topic over the years (e.g.
in the original 2011 article linked above, as well as in Python 3 Q &amp;amp; A answers
&lt;a class="reference external" href="http://python-notes.curiousefficiency.org/en/latest/python3/questions_and_answers.html#wouldn-t-a-python-2-8-release-help-ease-the-transition"&gt;here&lt;/a&gt;,
&lt;a class="reference external" href="http://python-notes.curiousefficiency.org/en/latest/python3/questions_and_answers.html#doesn-t-this-make-python-look-like-an-immature-and-unstable-platform"&gt;here&lt;/a&gt;,
and &lt;a class="reference external" href="http://python-notes.curiousefficiency.org/en/latest/python3/questions_and_answers.html#what-about-insert-other-shiny-new-feature-here"&gt;here&lt;/a&gt;,
and to a lesser degree in last year's article on the
&lt;a class="reference external" href="http://www.curiousefficiency.org/posts/2016/09/python-packaging-ecosystem.html"&gt;Python Packaging Ecosystem&lt;/a&gt;),
I've never really attempted to directly explain the impact it has on the standard
library design process.&lt;/p&gt;
&lt;p&gt;And without that background, some aspects of the design process, such as the
introduction of provisional APIs, or the introduction of
inspired-by-but-not-the-same-as, seem completely nonsensical, as they appear to be an attempt to standardise
APIs without actually standardising them.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="where-does-pypi-fit-into-the-picture"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="http://www.curiousefficiency.org/posts/2017/10/considering-pythons-target-audience.html#id4"&gt;Where does PyPI fit into the picture?&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The first hurdle that &lt;em&gt;any&lt;/em&gt; proposal sent to python-ideas or python-dev has to
clear is answering the question "Why isn't a module on PyPI good enough?". The
vast majority of proposals fail at this step, but there are several common
themes for getting past it:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;rather than downloading a suitable third party library, novices may be prone
to copying &amp;amp; pasting bad advice from the internet at large (e.g. this is why
the &lt;tt class="docutils literal"&gt;secrets&lt;/tt&gt; library now exists: to make it less likely people will use the
&lt;tt class="docutils literal"&gt;random&lt;/tt&gt; module, which is intended for games and statistical simulations,
for security-sensitive purposes)&lt;/li&gt;
&lt;li&gt;the module is intended to provide a reference implementation and to enable
interoperability between otherwise competing implementations, rather than
necessarily being all things to all people (e.g. &lt;tt class="docutils literal"&gt;asyncio&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;wsgiref&lt;/tt&gt;,
&lt;tt class="docutils literal"&gt;unittest`&lt;/tt&gt;, and &lt;tt class="docutils literal"&gt;logging&lt;/tt&gt; all fall into this category)&lt;/li&gt;
&lt;li&gt;the module is intended for use in other parts of the standard library (e.g.
&lt;tt class="docutils literal"&gt;enum&lt;/tt&gt; falls into this category, as does &lt;tt class="docutils literal"&gt;unittest&lt;/tt&gt;)&lt;/li&gt;
&lt;li&gt;the module is designed to support a syntactic addition to the language (e.g.
the &lt;tt class="docutils literal"&gt;contextlib&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;asyncio&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;typing&lt;/tt&gt; modules fall into this
category)&lt;/li&gt;
&lt;li&gt;the module is just plain useful for ad hoc scripting purposes (e.g.
&lt;tt class="docutils literal"&gt;pathlib&lt;/tt&gt;, and &lt;tt class="docutils literal"&gt;ipaddress&lt;/tt&gt; fall into this category)&lt;/li&gt;
&lt;li&gt;the module is useful in an educational context (e.g. the &lt;tt class="docutils literal"&gt;statistics&lt;/tt&gt;
module allows for interactive exploration of statistic concepts, even if you
wouldn't necessarily want to use it for full-fledged statistical analysis)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Passing this initial "Is PyPI obviously good enough?" check isn't enough to
ensure that a module will be accepted for inclusion into the standard library,
but it's enough to shift the question to become "Would including the proposed
library result in a net improvement to the typical introductory Python software
developer experience over the next few years?"&lt;/p&gt;
&lt;p&gt;The introduction of &lt;tt class="docutils literal"&gt;ensurepip&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;venv&lt;/tt&gt; modules into the standard library
also makes it clear to redistributors that we expect Python level packaging
and installation tools to be supported in addition to any platform specific
distribution mechanisms.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="why-are-some-apis-changed-when-adding-them-to-the-standard-library"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="http://www.curiousefficiency.org/posts/2017/10/considering-pythons-target-audience.html#id5"&gt;Why are some APIs changed when adding them to the standard library?&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;While existing third party modules are sometimes adopted wholesale into the
standard library, in other cases, what actually gets added is a redesigned
and reimplemented API that draws on the user experience of the existing API,
but drops or revises some details based on the additional design considerations
and privileges that go with being part of the language's reference
implementation.&lt;/p&gt;
&lt;p&gt;For example, unlike its popular third party predecessor, &lt;tt class="docutils literal"&gt;path.py`, ``pathlib&lt;/tt&gt;
does &lt;em&gt;not&lt;/em&gt; define string subclasses, but instead independent types. Solving
the resulting interoperability challenges led to the definition of the
filesystem path protocol, allowing a wider range of objects to be used with
interfaces that work with filesystem paths.&lt;/p&gt;
&lt;p&gt;The API design for the &lt;tt class="docutils literal"&gt;ipaddress&lt;/tt&gt; module was adjusted to explicitly
separate host interface definitions (IP addresses associated with particular
IP networks) from the definitions of addresses and networks in order to serve
as a better tool for teaching IP addressing concepts, whereas the original
&lt;tt class="docutils literal"&gt;ipaddr&lt;/tt&gt; module is less strict in the way it uses networking terminology.&lt;/p&gt;
&lt;p&gt;In other cases, standard library modules are constructed as a synthesis of
multiple existing approaches, and may also rely on syntactic features that
didn't exist when the APIs for pre-existing libraries were defined. Both of
these considerations apply for the &lt;tt class="docutils literal"&gt;asyncio&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;typing&lt;/tt&gt; modules,
while the latter consideration applies for the &lt;tt class="docutils literal"&gt;dataclasses&lt;/tt&gt; API being
considered in PEP 557 (which can be summarised as "like attrs, but using
variable annotations for field declarations").&lt;/p&gt;
&lt;p&gt;The working theory for these kinds of changes is that the existing libraries
aren't going away, and their maintainers often aren't all that interested
in putitng up with the constraints associated with standard library maintenance
(in particular, the relatively slow release cadence). In such cases, it's
fairly common for the documentation of the standard library version to feature
a "See Also" link pointing to the original module, especially if the third
party version offers additional features and flexibility that were omitted
from the standard library module.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="why-are-some-apis-added-in-provisional-form"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="http://www.curiousefficiency.org/posts/2017/10/considering-pythons-target-audience.html#id6"&gt;Why are some APIs added in provisional form?&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;While CPython does maintain an API deprecation policy, we generally prefer not
to use it without a compelling justification (this is especially the case
while other projects are attempting to maintain compatibility with Python 2.7).&lt;/p&gt;
&lt;p&gt;However, when adding new APIs that are inspired by existing third party ones
without being exact copies of them, there's a higher than usual risk that some
of the design decisions may turn out to be problematic in practice.&lt;/p&gt;
&lt;p&gt;When we consider the risk of such changes to be higher than usual, we'll mark
the related APIs as provisional, indicating that conservative end users may
want to avoid relying on them at all, and that developers of shared abstraction
layers may want to consider imposing stricter than usual constraints on which
versions of the provisional API they're prepared to support.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="why-are-only-some-standard-library-apis-upgraded"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="http://www.curiousefficiency.org/posts/2017/10/considering-pythons-target-audience.html#id7"&gt;Why are only some standard library APIs upgraded?&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;The short answer here is that the main APIs that get upgraded are those where:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;there isn't likely to be a lot of external churn driving additional updates&lt;/li&gt;
&lt;li&gt;there are clear benefits for either ad hoc scripting use cases or else in
encouraging future interoperability between multiple third party solutions&lt;/li&gt;
&lt;li&gt;a credible proposal is submitted by folks interested in doing the work&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;If the limitations of an existing module are mainly noticeable when using the
module for application development purposes (e.g. &lt;tt class="docutils literal"&gt;datetime&lt;/tt&gt;), if
redistributors already tend to make an improved alternative third party option
readily available (e.g. &lt;tt class="docutils literal"&gt;requests&lt;/tt&gt;), or if there's a genuine conflict between
the release cadence of the standard library and the needs of the package in
question (e.g. &lt;tt class="docutils literal"&gt;certifi&lt;/tt&gt;), then the incentives to propose a change to the
standard library version tend to be significantly reduced.&lt;/p&gt;
&lt;p&gt;This is essentially the inverse to the question about PyPI above: since PyPI
usually &lt;em&gt;is&lt;/em&gt; a sufficiently good distribution mechanism for application
developer experience enhancements, it makes sense for such enhancements to be
distributed that way, allowing redistributors and platform providers to make
their own decisions about what they want to include as part of their default
offering.&lt;/p&gt;
&lt;p&gt;Changing CPython and the standard library only comes into play when there is
perceived value in changing the capabilities that can be assumed to be present
by default in 3-5 years time.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="will-any-parts-of-the-standard-library-ever-be-independently-versioned"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="http://www.curiousefficiency.org/posts/2017/10/considering-pythons-target-audience.html#id8"&gt;Will any parts of the standard library ever be independently versioned?&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Yes, it's likely the bundling model used for &lt;tt class="docutils literal"&gt;ensurepip&lt;/tt&gt; (where CPython
releases bundle a recent version of &lt;tt class="docutils literal"&gt;pip&lt;/tt&gt; without actually making it part
of the standard library) may be applied to other modules in the future.&lt;/p&gt;
&lt;p&gt;The most probable first candidate for that treatment would be the &lt;tt class="docutils literal"&gt;distutils&lt;/tt&gt;
build system, as switching to such a model would allow the build system to be
more readily kept consistent across multiple releases.&lt;/p&gt;
&lt;p&gt;Other potential candidates for this kind of treatment would be the Tcl/Tk
graphics bindings, and the IDLE editor, which are already unbundled and turned
into an optional addon installations by a number of redistributors.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="why-do-these-considerations-matter"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="http://www.curiousefficiency.org/posts/2017/10/considering-pythons-target-audience.html#id9"&gt;Why do these considerations matter?&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;By the very nature of things, the folks that tend to be most actively involved
in open source development are those folks working on open source applications
and shared abstraction layers.&lt;/p&gt;
&lt;p&gt;The folks writing ad hoc scripts or designing educational exercises for their
students often won't even think of themselves as software developers - they're
teachers, system administrators, data analysts, quants, epidemiologists,
physicists, biologists, business analysts, market researchers, animators,
graphical designers, etc.&lt;/p&gt;
&lt;p&gt;When all we have to worry about for a language is the application developer
experience, then we can make a lot of simplifying assumptions around what
people know, the kinds of tools they're using, the kinds of development
processes they're following, and the ways they're going to be building and
deploying their software.&lt;/p&gt;
&lt;p&gt;Things get significantly more complicated when an application runtime &lt;em&gt;also&lt;/em&gt;
enjoys broad popularity as a scripting engine. Doing either job well is
already difficult, and balancing the needs of both audiences as part of a single
project leads to frequent incomprehension and disbelief on both sides.&lt;/p&gt;
&lt;p&gt;This post isn't intended to claim that we never make incorrect decisions as part
of the CPython development process - it's merely pointing out that the most
reasonable reaction to seemingly nonsensical feature additions to the Python
standard library is going to be "I'm not part of the intended target audience
for that addition" rather than "I have no interest in that, so it must be a
useless and pointless addition of no value to anyone, added purely to annoy me".&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>python</category><guid>http://www.curiousefficiency.org/posts/2017/10/considering-pythons-target-audience.html</guid><pubDate>Mon, 09 Oct 2017 01:33:41 GMT</pubDate></item><item><title>The Python Packaging Ecosystem</title><link>http://www.curiousefficiency.org/posts/2016/09/python-packaging-ecosystem.html</link><dc:creator>Nick Coghlan</dc:creator><description>&lt;div&gt;&lt;div class="contents topic" id="from-development-to-deployment"&gt;
&lt;p class="topic-title first"&gt;From Development to Deployment&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference internal" href="http://www.curiousefficiency.org/posts/2016/09/python-packaging-ecosystem.html#my-core-software-ecosystem-design-philosophy" id="id1"&gt;My core software ecosystem design philosophy&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="http://www.curiousefficiency.org/posts/2016/09/python-packaging-ecosystem.html#the-key-conundrum" id="id2"&gt;The key conundrum&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="http://www.curiousefficiency.org/posts/2016/09/python-packaging-ecosystem.html#platform-management-or-plugin-management" id="id3"&gt;Platform management or plugin management?&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="http://www.curiousefficiency.org/posts/2016/09/python-packaging-ecosystem.html#where-do-we-go-next" id="id4"&gt;Where do we go next?&lt;/a&gt;&lt;ul&gt;
&lt;li&gt;&lt;a class="reference internal" href="http://www.curiousefficiency.org/posts/2016/09/python-packaging-ecosystem.html#sustainability-and-the-bystander-effect" id="id5"&gt;Sustainability and the bystander effect&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="http://www.curiousefficiency.org/posts/2016/09/python-packaging-ecosystem.html#migrating-pypi-to-pypi-org" id="id6"&gt;Migrating PyPI to pypi.org&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="http://www.curiousefficiency.org/posts/2016/09/python-packaging-ecosystem.html#making-the-presence-of-a-compiler-on-end-user-systems-optional" id="id7"&gt;Making the presence of a compiler on end user systems optional&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="http://www.curiousefficiency.org/posts/2016/09/python-packaging-ecosystem.html#bootstrapping-dependency-management-tools-on-end-user-systems" id="id8"&gt;Bootstrapping dependency management tools on end user systems&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="http://www.curiousefficiency.org/posts/2016/09/python-packaging-ecosystem.html#making-the-use-of-distutils-and-setuptools-optional" id="id9"&gt;Making the use of distutils and setuptools optional&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="http://www.curiousefficiency.org/posts/2016/09/python-packaging-ecosystem.html#making-pypi-security-independent-of-ssl-tls" id="id10"&gt;Making PyPI security independent of SSL/TLS&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="http://www.curiousefficiency.org/posts/2016/09/python-packaging-ecosystem.html#automating-wheel-creation" id="id11"&gt;Automating wheel creation&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;p&gt;There have been a few recent articles reflecting on the current status of
the Python packaging ecosystem from an end user perspective, so it seems
worthwhile for me to write-up my perspective as one of the lead architects
for that ecosystem on how I characterise the overall problem space of software
publication and distribution, where I think we are at the moment, and where I'd
like to see us go in the future.&lt;/p&gt;
&lt;p&gt;For context, the specific articles I'm replying to are:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference external" href="https://glyph.twistedmatrix.com/2016/08/python-packaging.html"&gt;Python Packaging is Good Now&lt;/a&gt; (Glyph Lefkowitz)&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="https://jakevdp.github.io/blog/2016/08/25/conda-myths-and-misconceptions/"&gt;Conda: Myths and Misconceptions&lt;/a&gt; (Jake VanderPlas)&lt;/li&gt;
&lt;li&gt;&lt;a class="reference external" href="https://www.paypal-engineering.com/2016/09/07/python-packaging-at-paypal/"&gt;Python Packaging at PayPal&lt;/a&gt; (Mahmoud Hashemi)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;These are all excellent pieces considering the problem space from different
perspectives, so if you'd like to learn more about the topics I cover here,
I highly recommend reading them.&lt;/p&gt;
&lt;div class="section" id="my-core-software-ecosystem-design-philosophy"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="http://www.curiousefficiency.org/posts/2016/09/python-packaging-ecosystem.html#id1"&gt;My core software ecosystem design philosophy&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Since it heavily influences the way I think about packaging system design in
general, it's worth stating my core design philosophy explicitly:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;As a software consumer, I should be able to consume libraries, frameworks,
and applications in the binary format of my choice, regardless of whether
or not the relevant software publishers directly publish in that format&lt;/li&gt;
&lt;li&gt;As a software publisher working in the Python ecosystem, I should be able to
publish my software once, in a single source-based format, and have it be
automatically consumable in any binary format my users care to use&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This is emphatically &lt;em&gt;not&lt;/em&gt; the way many software packaging systems work - for a
great many systems, the publication format and the consumption format are
tightly coupled, and the folks managing the publication format or the
consumption format actively seek to use it as a lever of control over a
commercial market (think operating system vendor controlled application stores,
especially for mobile devices).&lt;/p&gt;
&lt;p&gt;While we're unlikely to ever pursue the specific design documented in the
rest of the PEP (hence the "Deferred" status), the
"&lt;a class="reference external" href="https://www.python.org/dev/peps/pep-0426/#development-distribution-and-deployment-of-python-software"&gt;Development, Distribution, and Deployment of Python Software&lt;/a&gt;"
section of PEP 426 provides additional details on how this philosophy applies
in practice.&lt;/p&gt;
&lt;p&gt;I'll also note that while I now work on software supply chain management
tooling at Red Hat, that &lt;em&gt;wasn't&lt;/em&gt; the case when I first started actively
participating in the upstream Python packaging ecosystem
&lt;a class="reference external" href="https://lwn.net/Articles/580399/"&gt;design process&lt;/a&gt;. Back then I was working
on Red Hat's main
&lt;a class="reference external" href="https://beaker-project.org/"&gt;hardware integration testing system&lt;/a&gt;, and
growing increasingly frustrated with the level of effort involved in
integrating new Python level dependencies into Beaker's RPM based development
and deployment model. Getting actively involved in tackling these problems on
the Python upstream side of things then led to also getting more actively
involved in addressing them on the
&lt;a class="reference external" href="http://www.slideshare.net/ncoghlan_dev/developing-in-python-on-red-hat-platforms-devnation-2016"&gt;Red Hat downstream side&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="the-key-conundrum"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="http://www.curiousefficiency.org/posts/2016/09/python-packaging-ecosystem.html#id2"&gt;The key conundrum&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;When talking about the design of software packaging ecosystems, it's very easy
to fall into the trap of only considering  the "direct to peer developers" use
case, where the software consumer we're attempting to reach is another developer
working in the same problem domain that we are, using a similar set of
development tools. Common examples of this include:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Linux distro developers publishing software for use by other contributors to
the same Linux distro ecosystem&lt;/li&gt;
&lt;li&gt;Web service developers publishing software for use by other web service
developers&lt;/li&gt;
&lt;li&gt;Data scientists publishing software for use by other data scientists&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;In these more constrained contexts, you can frequently get away with using a
single toolchain for both publication and consumption:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Linux: just use the system package manager for the relevant distro&lt;/li&gt;
&lt;li&gt;Web services: just use the Python Packaging Authority's twine for publication
and pip for consumption&lt;/li&gt;
&lt;li&gt;Data science: just use conda for everything&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;For newer languages that start in one particular domain with a preferred
package manager and expand outwards from there, the apparent simplicity arising
from this homogeneity of use cases may frequently be attributed as an essential
property of the design of the package manager, but that perception of inherent
simplicity will typically fade if the language is able to successfully expand
beyond the original niche its default package manager was designed to handle.&lt;/p&gt;
&lt;p&gt;In the case of Python, for example, distutils was designed as a consistent
build interface for Linux distro package management, setuptools for plugin
management in the Open Source Application Foundation's Chandler project, pip
for dependency management in web service development, and conda for local
language-independent environment management in data science.
distutils and setuptools haven't fared especially well from a usability
perspective when pushed beyond their original design parameters (hence the
current efforts to make it easier to use full-fledged build systems like
Scons and Meson as an alternative when publishing Python packages), while pip
and conda both seem to be doing a better job of accommodating increases in
their scope of application.&lt;/p&gt;
&lt;p&gt;This history helps illustrate that where things really have the potential to
get complicated (even beyond the inherent challenges of domain-specific
software distribution) is when you start needing to &lt;em&gt;cross domain boundaries&lt;/em&gt;.
For example, as the lead maintainer of &lt;tt class="docutils literal"&gt;contextlib&lt;/tt&gt; in the Python
standard library, I'm also the maintainer of the &lt;tt class="docutils literal"&gt;contextlib2&lt;/tt&gt; backport
project on PyPI. That's not a domain specific utility - folks may need it
regardless of whether they're using a self-built Python runtime, a pre-built
Windows or Mac OS X binary they downloaded from python.org, a pre-built
binary from a Linux distribution, a CPython runtime from some other
redistributor (homebrew, pyenv, Enthought Canopy, ActiveState,
Continuum Analytics, AWS Lambda, Azure Machine Learning, etc), or perhaps even
a different Python runtime entirely (PyPy, PyPy.js, Jython, IronPython,
MicroPython, VOC, Batavia, etc).&lt;/p&gt;
&lt;p&gt;Fortunately for me, I &lt;em&gt;don't&lt;/em&gt; need to worry about all that complexity in the
wider ecosystem when I'm specifically wearing my &lt;tt class="docutils literal"&gt;contextlib2&lt;/tt&gt; maintainer
hat - I just publish an sdist and a universal wheel file to PyPI, and the rest
of the ecosystem has everything it needs to take care of redistribution
and end user consumption without any further input from me.&lt;/p&gt;
&lt;p&gt;However, &lt;tt class="docutils literal"&gt;contextlib2&lt;/tt&gt; is a pure Python project that only depends on the
standard library, so it's pretty much the simplest possible case from a
tooling perspective (the only reason I needed to upgrade from distutils to
setuptools was so I could publish my own wheel files, and the only reason I
haven't switched to using the &lt;em&gt;much&lt;/em&gt; simpler pure-Python-only flit instead of
either of them is that that doesn't yet easily support publishing backwards
compatible setup.py based sdists).&lt;/p&gt;
&lt;p&gt;This means that things get significantly more complex once we start wanting to
use and depend on components written in languages other than Python, so that's
the broader context I'll consider next.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="platform-management-or-plugin-management"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="http://www.curiousefficiency.org/posts/2016/09/python-packaging-ecosystem.html#id3"&gt;Platform management or plugin management?&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;When it comes to handling the software distribution problem in general, there
are two main ways of approaching it:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;design a plugin management system that doesn't concern itself with the
management of the application framework that &lt;em&gt;runs&lt;/em&gt; the plugins&lt;/li&gt;
&lt;li&gt;design a platform component manager that not only manages the plugins
themselves, but &lt;em&gt;also&lt;/em&gt; the application frameworks that run them&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This "plugin manager or platform component manager?" question shows up over and
over again in software distribution architecture designs, but the case of most
relevance to Python developers is in the contrasting approaches that pip and
conda have adopted to handling the problem of external dependencies for Python
projects:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;pip is a &lt;em&gt;plugin manager&lt;/em&gt; for Python runtimes. Once you have a Python runtime
(any Python runtime), pip can help you add pieces to it. However, by design,
it won't help you manage the underlying Python runtime (just as it wouldn't
make any sense to try to install Mozilla Firefox as a Firefox Add-On, or
Google Chrome as a Chrome Extension)&lt;/li&gt;
&lt;li&gt;conda, by contrast, is a &lt;em&gt;component manager&lt;/em&gt; for a cross-platform platform
that provides its own Python runtimes (as well as runtimes for other
languages). This means that you can get &lt;em&gt;pre-integrated&lt;/em&gt; components, rather
than having to do your own integration between plugins obtained via pip and
language runtimes obtained via other means&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;What this means is that pip, &lt;em&gt;on its own&lt;/em&gt;, is not in any way a direct
alternative to conda. To get comparable capabilities to those offered by conda,
you have to add in a mechanism for obtaining the underlying language runtimes,
which means the alternatives are combinations like:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;apt-get + pip&lt;/li&gt;
&lt;li&gt;dnf + pip&lt;/li&gt;
&lt;li&gt;yum + pip&lt;/li&gt;
&lt;li&gt;pyenv + pip&lt;/li&gt;
&lt;li&gt;homebrew (Mac OS X) + pip&lt;/li&gt;
&lt;li&gt;python.org Windows installer + pip&lt;/li&gt;
&lt;li&gt;Enthought Canopy&lt;/li&gt;
&lt;li&gt;ActiveState's Python runtime + PyPM&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This is the main reason why "just use conda" is excellent advice to any
prospective Pythonista that isn't already using one of the platform component
managers mentioned above: giving that answer replaces an otherwise operating
system dependent or Python specific answer to the runtime management problem
with a cross-platform and (at least somewhat) language neutral one.&lt;/p&gt;
&lt;p&gt;It's an especially good answer for Windows users, as chocalatey/OneGet/Windows
Package Management isn't remotely comparable to pyenv or homebrew at this point
in time, other runtime managers don't work on Windows, and getting folks
bootstrapped with MinGW, Cygwin or the new (still experimental) Windows
Subsystem for Linux is just another hurdle to place between them and whatever
goal they're learning Python for in the first place.&lt;/p&gt;
&lt;p&gt;However, conda's pre-integration based approach to tackling the external
dependency problem is also why "just use conda for everything" isn't a
sufficient answer for the Python software ecosystem as a whole.&lt;/p&gt;
&lt;p&gt;If you're working on an operating system component for Fedora, Debian, or any
other distro, you actually &lt;em&gt;want&lt;/em&gt; to be using the system provided Python
runtime, and hence need to be able to readily convert your upstream Python
dependencies into policy compliant system dependencies.&lt;/p&gt;
&lt;p&gt;Similarly, if you're wanting to support folks that deploy to a preconfigured
Python environment in services like AWS Lambda, Azure Cloud Functions, Heroku,
OpenShift or Cloud Foundry, or that use alternative Python runtimes like PyPy
or MicroPython, then you need a publication technology that doesn't tightly
couple your releases to a specific version of the underlying language runtime.&lt;/p&gt;
&lt;p&gt;As a result, pip and conda end up existing at slightly different points in the
system integration pipeline:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;Publishing and consuming Python software with pip is a matter of "bring your
own Python runtime". This has the benefit that you &lt;em&gt;can&lt;/em&gt; readily bring your
own runtime (and manage it using whichever tools make sense for your use
case), but also has the downside that you &lt;em&gt;must&lt;/em&gt; supply your own runtime
(which can sometimes prove to be a significant barrier to entry for new
Python users, as well as being a pain for cross-platform environment
management).&lt;/li&gt;
&lt;li&gt;Like Linux system package managers before it, conda takes away the
requirement to supply your own Python runtime by providing one for you.
This is great if you don't have any particular preference as to which
runtime you want to use, but if you &lt;em&gt;do&lt;/em&gt; need to use a different runtime
for some reason, you're likely to end up fighting against the tooling, rather
than having it help you. (If you're tempted to answer "Just add another
interpreter to the pre-integrated set!" here, keep in mind that doing so
without the aid of a runtime independent plugin manager like pip acts as a
&lt;em&gt;multiplier&lt;/em&gt; on the platform level integration testing needed, which can be a
significant cost even when it's automated)&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div class="section" id="where-do-we-go-next"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="http://www.curiousefficiency.org/posts/2016/09/python-packaging-ecosystem.html#id4"&gt;Where do we go next?&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;In case it isn't already clear from the above, I'm largely happy with the
respective niches that pip and conda are carving out for themselves as a
plugin manager for Python runtimes and as a cross-platform platform focused
on (but not limited to) data analysis use cases.&lt;/p&gt;
&lt;p&gt;However, there's still plenty of scope to improve the effectiveness of the
collaboration between the upstream Python Packaging Authority and downstream
Python redistributors, as well as to reduce barriers to entry for participation
in the ecosystem in general, so I'll go over some of the key areas I see for
potential improvement.&lt;/p&gt;
&lt;div class="section" id="sustainability-and-the-bystander-effect"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="http://www.curiousefficiency.org/posts/2016/09/python-packaging-ecosystem.html#id5"&gt;Sustainability and the bystander effect&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;It's not a secret that the core PyPA infrastructure (PyPI, pip, twine,
setuptools) is
&lt;a class="reference external" href="https://caremad.io/posts/2016/05/powering-pypi/"&gt;nowhere near as well-funded&lt;/a&gt;
as you might expect given its criticality to the operations of some truly
enormous organisations.&lt;/p&gt;
&lt;p&gt;The biggest impact of this is that even when volunteers show up ready and
willing to work, there may not be anybody in a position to effectively &lt;em&gt;wrangle&lt;/em&gt;
those volunteers, and help keep them collaborating effectively and moving in a
productive direction.&lt;/p&gt;
&lt;p&gt;To secure long term sustainability for the core Python packaging infrastructure,
we're only talking amounts on the order of a few hundred thousand dollars a
year - enough to cover some dedicated operations and publisher support staff for
PyPI (freeing up the volunteers currently handling those tasks to help work on
ecosystem improvements), as well as to fund targeted development directed at
some of the other problems described below.&lt;/p&gt;
&lt;p&gt;However, rather than being a true
"&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Tragedy_of_the_commons"&gt;tragedy of the commons&lt;/a&gt;",
I personally chalk this situation up to a different human cognitive bias: the
&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Bystander_effect"&gt;bystander effect&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;The reason I think that is that we have &lt;em&gt;so many&lt;/em&gt; potential sources of the
necessary funding that even folks that agree there's a problem that needs to be
solved are assuming that someone else will take care of it, without actually
checking whether or not that assumption is entirely valid.&lt;/p&gt;
&lt;p&gt;The primary responsibility for correcting that oversight falls squarely on the
Python Software Foundation, which is why the Packaging Working Group was
formed in order to investigate possible sources of additional funding, as well
as to determine how any such funding can be spent most effectively.&lt;/p&gt;
&lt;p&gt;However, a secondary responsibility also falls on customers and staff of
commercial Python redistributors, as this is &lt;em&gt;exactly&lt;/em&gt; the kind of ecosystem
level risk that commercial redistributors are being paid to manage on behalf of
their customers, and they're currently not handling this particular situation
very well. Accordingly, anyone that's actually &lt;em&gt;paying&lt;/em&gt; for CPython, pip, and
related tools (either directly or as a component of a larger offering), and
expecting them to be supported properly as a result, really needs to be asking
some very pointed question of their suppliers right about now. (Here's a sample
question: "We pay you X dollars a year, and the upstream Python ecosystem is
one of the things we expect you to support with that revenue. How much of what
we pay you goes towards maintenance of the upstream Python packaging
infrastructure that we rely on every day?").&lt;/p&gt;
&lt;p&gt;One key point to note about the current situation is that as a 501(c)(3) public
interest charity, any work the PSF funds will be directed towards better
fulfilling that public interest mission, and that means focusing primarily on
the needs of educators and non-profit organisations, rather than those of
private for-profit entities.&lt;/p&gt;
&lt;p&gt;Commercial redistributors are thus &lt;em&gt;far&lt;/em&gt; better positioned to properly
represent their customers interests in areas where their priorities may
diverge from those of the wider community (closing the "insider threat"
loophole in PyPI's current security model is a particular case that comes to
mind - see &lt;a class="reference internal" href="http://www.curiousefficiency.org/posts/2016/09/python-packaging-ecosystem.html#making-pypi-security-independent-of-ssl-tls"&gt;Making PyPI security independent of SSL/TLS&lt;/a&gt;).&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="migrating-pypi-to-pypi-org"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="http://www.curiousefficiency.org/posts/2016/09/python-packaging-ecosystem.html#id6"&gt;Migrating PyPI to pypi.org&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;An instance of the new PyPI implementation (Warehouse) is up and running at
&lt;a class="reference external" href="https://pypi.org/"&gt;https://pypi.org/&lt;/a&gt; and connected directly to the
production PyPI database, so folks can already explicitly opt-in to using it
over the legacy implementation if they prefer to do so.&lt;/p&gt;
&lt;p&gt;However, there's still a non-trivial amount of design, development and QA work
needed on the new version before all existing traffic can be transparently
switched over to using it.&lt;/p&gt;
&lt;p&gt;Getting at least this step appropriately funded and a clear project management
plan in place is the main current focus of the PSF's Packaging Working Group.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="making-the-presence-of-a-compiler-on-end-user-systems-optional"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="http://www.curiousefficiency.org/posts/2016/09/python-packaging-ecosystem.html#id7"&gt;Making the presence of a compiler on end user systems optional&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;Between the &lt;tt class="docutils literal"&gt;wheel&lt;/tt&gt; format and the &lt;tt class="docutils literal"&gt;manylinux1&lt;/tt&gt; usefully-distro-independent
ABI definition, this is largely handled now, with &lt;tt class="docutils literal"&gt;conda&lt;/tt&gt; available as an
option to handle the relatively small number of cases that are still a problem
for &lt;tt class="docutils literal"&gt;pip&lt;/tt&gt;.&lt;/p&gt;
&lt;p&gt;The main unsolved problem is to allow projects to properly express the
constraints they place on target environments so that issues can be detected
at install time or repackaging time, rather than only being detected as
runtime failures. Such a feature will also greatly expand the ability to
correctly generate platform level dependencies when converting Python
projects to downstream package formats like those used by conda and Linux
system package managers.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="bootstrapping-dependency-management-tools-on-end-user-systems"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="http://www.curiousefficiency.org/posts/2016/09/python-packaging-ecosystem.html#id8"&gt;Bootstrapping dependency management tools on end user systems&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;With pip being bundled with recent versions of CPython (including CPython 2.7
maintenance releases), and pip (or a variant like upip) also being bundled with
most other Python runtimes, the ecosystem bootstrapping problem has largely
been addressed for new Python users.&lt;/p&gt;
&lt;p&gt;There are still a few usability challenges to be addressed (like defaulting
to per-user installations when outside a virtual environment, interoperating
more effectively with platform component managers like conda, and providing
an officially supported installation interface that works at the Python prompt
rather than via the operating system command line), but those don't require
the same level of political coordination across multiple groups that was
needed to establish pip as the lowest common denominator approach to
dependency management for Python applications.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="making-the-use-of-distutils-and-setuptools-optional"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="http://www.curiousefficiency.org/posts/2016/09/python-packaging-ecosystem.html#id9"&gt;Making the use of distutils and setuptools optional&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;As mentioned above, distutils was designed ~18 years ago as a common interface
for Linux distributions to build Python projects, while setuptools was designed
~12 years ago as a plugin management system for an open source Microsoft
Exchange replacement. While both projects have given admirable service in
their original target niches, and quite a few more besides, their age and
original purpose means they're significantly more complex than what a user
needs if all they want to do is to publish their pure Python library or
framework to the Python Package index.&lt;/p&gt;
&lt;p&gt;Their underlying complexity also makes it incredibly difficult to improve the
problematic state of their documentation, which is split between the legacy
distutils documentation in the CPython standard library and the additional
setuptools specific documentation in the setuptools project.&lt;/p&gt;
&lt;p&gt;Accordingly, what we want to do is to change the way build toolchains for
Python projects are organised to have 3 clearly distinct tiers:&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;toolchains for pure Python projects&lt;/li&gt;
&lt;li&gt;toolchains for Python projects with simple C extensions&lt;/li&gt;
&lt;li&gt;toolchains for C/C++/other projects with Python bindings&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;This allows folks to be introduced to simpler tools like flit first, better
enables the development of potential alternatives to setuptools at the second
tier, and supports the use of full-fledged pip-installable build systems like
Scons and Meson at the third tier.&lt;/p&gt;
&lt;p&gt;The first step in this project, defining the &lt;tt class="docutils literal"&gt;pyproject.toml&lt;/tt&gt; format to allow
declarative specification of the dependencies needed to launch &lt;tt class="docutils literal"&gt;setup.py&lt;/tt&gt;,
has been implemented, and Daniel Holth's &lt;tt class="docutils literal"&gt;enscons&lt;/tt&gt; project demonstrates that
that is already sufficient to bootstrap an external build system even without
the later stages of the project.&lt;/p&gt;
&lt;p&gt;Future steps include providing native support for &lt;tt class="docutils literal"&gt;pyproject.toml&lt;/tt&gt; in &lt;tt class="docutils literal"&gt;pip&lt;/tt&gt;
and &lt;tt class="docutils literal"&gt;easy_install&lt;/tt&gt;, as well as defining a declarative approach to invoking
the build system rather than having to run &lt;tt class="docutils literal"&gt;setup.py&lt;/tt&gt; with the relevant
distutils &amp;amp; setuptools flags.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="making-pypi-security-independent-of-ssl-tls"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="http://www.curiousefficiency.org/posts/2016/09/python-packaging-ecosystem.html#id10"&gt;Making PyPI security independent of SSL/TLS&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;PyPI currently relies entirely on SSL/TLS to protect the integrity of the link
between software publishers and PyPI, and between PyPI and software consumers.
The only protections against insider threats from within the PyPI
administration team are ad hoc usage of GPG artifact signing by some projects,
personal vetting of new team members by existing team members and 3rd party
checks against previously published artifact hashes unexpectedly changing.&lt;/p&gt;
&lt;p&gt;A credible design for end-to-end package signing that adequately accounts for
the significant usability issues that can arise around publisher and consumer
key management has been available for almost 3 years at this point (see
&lt;a class="reference external" href="https://www.python.org/dev/peps/pep-0458/"&gt;Surviving a Compromise of PyPI&lt;/a&gt;
and
&lt;a class="reference external" href="https://www.python.org/dev/peps/pep-0480/"&gt;Surviving a Compromise of PyPI: the Maximum Security Edition&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;However, implementing that solution has been gated not only on being able to
first retire the legacy infrastructure, but also the PyPI administators being
able to credibly commit to the key management obligations of operating the
signing system, as well as to ensuring that the system-as-implemented actually
provides the security guarantees of the system-as-designed.&lt;/p&gt;
&lt;p&gt;Accordingly, this isn't a project that can realistically be pursued until the
underlying sustainability problems have been suitably addressed.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="automating-wheel-creation"&gt;
&lt;h3&gt;&lt;a class="toc-backref" href="http://www.curiousefficiency.org/posts/2016/09/python-packaging-ecosystem.html#id11"&gt;Automating wheel creation&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;While redistributors will generally take care of converting upstream Python
packages into their own preferred formats, the Python-specific wheel format
is currently a case where it is left up to publishers to decide whether or
not to create them, and if they do decide to create them, how to automate that
process.&lt;/p&gt;
&lt;p&gt;Having PyPI take care of this process automatically is an obviously desirable
feature, but it's also an incredibly expensive one to build and operate.&lt;/p&gt;
&lt;p&gt;Thus, it currently makes sense to defer this cost to individual projects, as
there are quite a few commercial continuous integration and continuous
deployment service providers willing to offer free accounts to open source
projects, and these can also be used for the task of producing release
artifacts. Projects also remain free to only publish source artifacts, relying
on pip's implicit wheel creation and caching and the appropriate use of
private PyPI mirrors and caches to meet the needs of end users.&lt;/p&gt;
&lt;p&gt;For downstream platform communities already offering shared build
infrastructure to their members (such as Linux distributions and conda-forge),
it may make sense to offer Python wheel generation as a supported output option
for cross-platform development use cases, in addition to the platform's native
binary packaging format.&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>python</category><guid>http://www.curiousefficiency.org/posts/2016/09/python-packaging-ecosystem.html</guid><pubDate>Sat, 17 Sep 2016 03:46:31 GMT</pubDate></item><item><title>What problem does it solve?</title><link>http://www.curiousefficiency.org/posts/2016/08/what-problem-does-it-solve.html</link><dc:creator>Nick Coghlan</dc:creator><description>&lt;div&gt;&lt;p&gt;One of the more puzzling aspects of Python for newcomers to the language is the
stark usability differences between the standard library's &lt;code&gt;urllib&lt;/code&gt; module
and the popular (and well-recommended) third party module, &lt;code&gt;requests&lt;/code&gt;, when
it comes to writing HTTP(S) protocol clients. When your problem is
"talk to a HTTP server", the difference in usability isn't immediately obvious,
but it becomes clear as soon as additional requirements like SSL/TLS,
authentication, redirect handling, session management, and JSON request and
response bodies enter the picture.&lt;/p&gt;
&lt;p&gt;It's tempting, and entirely understandable, to want to
&lt;a href="http://noamelf.com/2016/08/05/designing-pythonic-apis/"&gt;chalk this difference&lt;/a&gt;
in ease of use up to &lt;code&gt;requests&lt;/code&gt; being "Pythonic" (in 2016 terms), while &lt;code&gt;urllib&lt;/code&gt;
has now become un-Pythonic (despite being included in the standard library).&lt;/p&gt;
&lt;p&gt;While there are certainly a few elements of that (e.g. the &lt;code&gt;property&lt;/code&gt; builtin
was only added in Python 2.2, while &lt;code&gt;urllib2&lt;/code&gt; was included in the original
Python 2.0 release and hence couldn't take that into account in its API design),
the vast majority of the usability difference relates to an entirely different
question we often forget to ask about the software we use:
&lt;em&gt;What problem does it solve?&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;That is, many otherwise surprising discrepancies between &lt;code&gt;urllib&lt;/code&gt;/&lt;code&gt;urllib2&lt;/code&gt;
and &lt;code&gt;requests&lt;/code&gt; are best explained by the fact that they &lt;em&gt;solve different
problems&lt;/em&gt;, and the problems most HTTP client developers have today
are closer to those Kenneth Reitz designed &lt;code&gt;requests&lt;/code&gt; to solve in 2010/2011,
than they are to the problems that Jeremy Hylton was aiming to solve more than
a decade earlier.&lt;/p&gt;
&lt;h3&gt;It's all in the name&lt;/h3&gt;
&lt;p&gt;To quote the current Python 3 &lt;code&gt;urllib&lt;/code&gt; package documentation: "urllib is a
package that collects several modules for working with URLs".&lt;/p&gt;
&lt;p&gt;And the docstring from Jeremy's
&lt;a href="https://hg.python.org/cpython/rev/b800e36aed4e"&gt;original commit message&lt;/a&gt;
adding &lt;code&gt;urllib2&lt;/code&gt; to CPython: "An extensible library for opening URLs using a
variety [of] protocols".&lt;/p&gt;
&lt;p&gt;Wait, what? We're just trying to write a HTTP client, so why is the
documentation talking about working with URLs in general?&lt;/p&gt;
&lt;p&gt;While it may seem strange to developers accustomed to the modern HTTPS+JSON
powered interactive web, it wasn't always clear that that was how things were
going to turn out.&lt;/p&gt;
&lt;p&gt;At the turn of the century, the expectation was instead that we'd retain a
rich variety of data transfer protocols with different characteristics optimised
for different purposes, and that the most useful client to have in the standard
library would be one that could be used to talk to multiple different kinds
of servers (like HTTP, FTP, NFS, etc), without client developers needing to
worry too much about the specific protocol used (as indicated by the URL
schema).&lt;/p&gt;
&lt;p&gt;In practice, things didn't work out that way (mostly due to restrictive
institutional firewalls meaning HTTP servers were the only remote services that
could be accessed reliably), so folks in 2016 are now regularly comparing the
usability of a dedicated HTTP(S)-only client library with a general purpose
URL handling library that needs to be configured to specifically be using
HTTP(S) before you gain access to most HTTP(S) features.&lt;/p&gt;
&lt;p&gt;When it was written, &lt;code&gt;urllib2&lt;/code&gt; was a square peg that was designed to fit into
the square hole of "generic URL processing". By contrast, most modern client
developers are looking for a round peg to fit into the round hole that is
HTTPS+JSON processing - &lt;code&gt;urllib&lt;/code&gt;/&lt;code&gt;urllib2&lt;/code&gt; will fit if you shave the corners
off first, but &lt;code&gt;requests&lt;/code&gt; comes pre-rounded.&lt;/p&gt;
&lt;h3&gt;So why not add requests to the standard library?&lt;/h3&gt;
&lt;p&gt;Answering the not-so-obvious question of "What problem does it solve?" then
leads to a more obvious follow-up question: if the problems that &lt;code&gt;urllib&lt;/code&gt;/
&lt;code&gt;urllib2&lt;/code&gt; were designed to solve are no longer common, while the problems that
&lt;code&gt;requests&lt;/code&gt; solves &lt;em&gt;are&lt;/em&gt; common, why not add &lt;code&gt;requests&lt;/code&gt; to the standard library?&lt;/p&gt;
&lt;p&gt;If I recall correctly, Guido gave in-principle approval to this idea at a
language summit back in 2013 or so (after the &lt;code&gt;requests&lt;/code&gt; 1.0 release), and it's
a fairly common assumption amongst the core development team that either
&lt;code&gt;requests&lt;/code&gt; itself (perhaps as a bundled snapshot of an independently upgradable
component) or a compatible subset of the API with a different implementation
will eventually end up in the standard library.&lt;/p&gt;
&lt;p&gt;However, even putting aside the
&lt;a href="https://github.com/kennethreitz/requests/issues/2424"&gt;misgivings of the requests developers&lt;/a&gt;
about the idea, there are still some non-trivial system integration problems
to solve in getting &lt;code&gt;requests&lt;/code&gt; to a point where it would be acceptable as a
standard library component.&lt;/p&gt;
&lt;p&gt;In particular, one of the things that &lt;code&gt;requests&lt;/code&gt; does to more reliably handle
SSL/TLS certificates in a cross-platform way is to bundle the Mozilla
Certificate Bundle included in the &lt;code&gt;certifi&lt;/code&gt; project. This is a sensible
thing to do by default (due to the difficulties of obtaining reliable access
to system security certificates in a cross-platform way), but it conflicts
with the security policy of the standard library, which specifically aims to
delegate certificate management to the underlying operating system. That policy
aims to address two needs: allowing Python applications access to custom
institutional certificates added to the system certificate store (most notably,
private CA certificates for large organisations), and avoiding adding an
additional certificate store to end user systems that needs to be updated when
the root certificate bundle changes for any other reason.&lt;/p&gt;
&lt;p&gt;These kinds of problems are technically solvable, but they're not fun to solve,
and the folks in a position to help solve them already have a great many other
demands on their time.This means we're not likely to see much in the way of
progress in this area as long as most of the CPython and &lt;code&gt;requests&lt;/code&gt; developers
are pursuing their upstream contributions as a spare time activity, rather than
as something they're specifically employed to do.&lt;/p&gt;&lt;/div&gt;</description><category>python</category><guid>http://www.curiousefficiency.org/posts/2016/08/what-problem-does-it-solve.html</guid><pubDate>Sat, 06 Aug 2016 11:05:53 GMT</pubDate></item><item><title>Propose a talk for the PyCon Australia Education Seminar!</title><link>http://www.curiousefficiency.org/posts/2016/05/pycon-australia-education-cfp-2016.html</link><dc:creator>Nick Coghlan</dc:creator><description>&lt;div&gt;&lt;h3&gt;The pitch&lt;/h3&gt;
&lt;div style="float: right"&gt;
  &lt;a href="http://www.oreilly.com/programming/free/python-in-education.csp"&gt;
    &lt;img src="http://www.curiousefficiency.org/files/python-in-education-cover.gif" alt="Python in Education cover"&gt;
   &lt;/a&gt;
&lt;/div&gt;

&lt;p&gt;Involved in Australian education, whether formally or informally?
Making use of Python in your classes, workshops or other activities?
Interested in sharing your efforts with other Australian educators, and with
the developers that create the tools you use? Able to get to the Melbourne
Convention &amp;amp; Exhibition Centre on Friday August 12th, 2016?&lt;/p&gt;
&lt;p&gt;Then please consider submitting a proposal to speak at the Python in Australian
Education seminar at PyCon Australia 2016! More information about the seminar
can be found
&lt;a href="https://2016.pycon-au.org/programme/python_in_education_seminar"&gt;here&lt;/a&gt;,
while details of the submission process are on the main
&lt;a href="https://2016.pycon-au.org/programme/call_for_proposals"&gt;Call for Proposals&lt;/a&gt;
page.&lt;/p&gt;
&lt;p&gt;Submissions close on Sunday May 8th, but may be edited further after submission
(including during the proposal review process based on feedback from reviewers).&lt;/p&gt;
&lt;p&gt;PyCon Australia is a community-run conference, so everyone involved is a
volunteer (organisers, reviewers, and speakers alike), but accepted speakers
are eligible for discounted (or even free) registration, and assistance with
other costs is also available to help ensure the conference doesn't miss out
on excellent presentations due to financial need (for teachers needing to
persuade skeptical school administrators, this assistance may extend to
contributing towards the costs of engaging a substitute teacher for the day).&lt;/p&gt;
&lt;h3&gt;The background&lt;/h3&gt;
&lt;p&gt;At PyCon Australia 2014, James Curran presented an excellent keynote on
&lt;a href="https://www.youtube.com/watch?v=iVv7fCwVbp4"&gt;"Python for Every Child in Australia"&lt;/a&gt;,
covering some of the history of the National Computer Science School, the
development of Australia's National Digital Curriculum (finally approved in
September 2015), and the opportunity this represented to introduce the next
generation of students to computational thinking in general, and Python in
particular.&lt;/p&gt;
&lt;p&gt;Encouraged by both Dr Curran's keynote at PyCon Australia, and Professor Lorena
Barba's
&lt;a href="https://www.youtube.com/watch?v=TWxwKDT88GU"&gt;"If There's Computational Thinking, There's Computational Learning"&lt;/a&gt; keynote at SciPy 2014, it was my honour and privilege
in 2015 not only to invite Carrie Anne Philbin, Education Pioneer at the
UK's Raspberry Pi Foundation, to speak at the main conference (on
&lt;a href="https://www.youtube.com/watch?v=gaFk0Sya_HI"&gt;"Designed for Education: a Python Solution"&lt;/a&gt;),
but also to invite her to keynote the inaugural Python in Australian Education
seminar. With the support of the Python Software Foundation and Code Club
Australia, Carrie Anne joined QSITE's Peter Whitehouse, Code Club Australia's
Kelly Tagalan, and several other local educators, authors and community workshop
organisers to present an informative, inspirational and sometimes challenging
&lt;a href="https://www.youtube.com/playlist?list=PLs4CJRBY5F1I5vuApyUXp6bLWly1E-b0s"&gt;series of talks&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;For 2016, we have a new location in Melbourne (PyCon Australia has a two year
rotation in each city, and the Education seminar was launched during the
second year in Brisbane), a new co-organiser (Katie Bell of Grok Learning and
the National Computer Science School), and a Call for Proposals and financial
assistance program that are fully integrated with those for the main conference.&lt;/p&gt;
&lt;p&gt;As with the main conference, however, the Python in Australian Education seminar
is designed around the idea of real world practitioners sharing information with
each other about their day to day experiences, what has worked well for them,
and what hasn't, and creating personal connections that can help facilitate
additional collaboration throughout the year.&lt;/p&gt;
&lt;p&gt;So, in addition to encouraging people to submit their own proposals, I'd also
encourage folks to talk to their friends and peers that they'd like to see
presenting, and see if they're interested in participating.&lt;/p&gt;&lt;/div&gt;</description><category>pycon-au</category><category>python</category><guid>http://www.curiousefficiency.org/posts/2016/05/pycon-australia-education-cfp-2016.html</guid><pubDate>Mon, 02 May 2016 01:29:23 GMT</pubDate></item><item><title>27 languages to improve your Python</title><link>http://www.curiousefficiency.org/posts/2015/10/languages-to-improve-your-python.html</link><dc:creator>Nick Coghlan</dc:creator><description>&lt;div&gt;&lt;div class="contents topic" id="languages"&gt;
&lt;p class="topic-title first"&gt;27 Languages&lt;/p&gt;
&lt;ul class="simple"&gt;
&lt;li&gt;&lt;a class="reference internal" href="http://www.curiousefficiency.org/posts/2015/10/languages-to-improve-your-python.html#broadening-our-horizons" id="id3"&gt;Broadening our horizons&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="http://www.curiousefficiency.org/posts/2015/10/languages-to-improve-your-python.html#procedural-programming-c-rust-cython" id="id4"&gt;Procedural programming: C, Rust, Cython&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="http://www.curiousefficiency.org/posts/2015/10/languages-to-improve-your-python.html#object-oriented-data-modelling-java-c-eiffel" id="id5"&gt;Object-oriented data modelling: Java, C#, Eiffel&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="http://www.curiousefficiency.org/posts/2015/10/languages-to-improve-your-python.html#object-oriented-c-derivatives-c-d" id="id6"&gt;Object-oriented C derivatives: C++, D&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="http://www.curiousefficiency.org/posts/2015/10/languages-to-improve-your-python.html#array-oriented-data-processing-matlab-octave-julia" id="id7"&gt;Array-oriented data processing: MATLAB/Octave, Julia&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="http://www.curiousefficiency.org/posts/2015/10/languages-to-improve-your-python.html#statistical-data-analysis-r" id="id8"&gt;Statistical data analysis: R&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="http://www.curiousefficiency.org/posts/2015/10/languages-to-improve-your-python.html#computational-pipeline-modelling-haskell-scala-clojure-f" id="id9"&gt;Computational pipeline modelling: Haskell, Scala, Clojure, F#&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="http://www.curiousefficiency.org/posts/2015/10/languages-to-improve-your-python.html#event-driven-programming-javascript-go-erlang-elixir" id="id10"&gt;Event driven programming: JavaScript, Go, Erlang, Elixir&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="http://www.curiousefficiency.org/posts/2015/10/languages-to-improve-your-python.html#gradual-typing-typescript" id="id11"&gt;Gradual typing: TypeScript&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="http://www.curiousefficiency.org/posts/2015/10/languages-to-improve-your-python.html#dynamic-metaprogramming-hy-ruby" id="id12"&gt;Dynamic metaprogramming: Hy, Ruby&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="http://www.curiousefficiency.org/posts/2015/10/languages-to-improve-your-python.html#pragmatic-problem-solving-lua-php-perl" id="id13"&gt;Pragmatic problem solving: Lua, PHP, Perl&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class="reference internal" href="http://www.curiousefficiency.org/posts/2015/10/languages-to-improve-your-python.html#computational-thinking-scratch-logo" id="id14"&gt;Computational thinking: Scratch, Logo&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;p&gt;As a co-designer of one of the world's most popular programming languages, one
of the more frustrating behaviours I regularly see (both in the Python community
and in others) is influential people trying to tap into fears of "losing" to
other open source communities as a motivating force for community contributions.
(I'm occasionally guilty of this misbehaviour myself, which makes it even
easier to spot when others are falling into the same trap).&lt;/p&gt;
&lt;p&gt;While learning from the experiences of other programming language communities
is a good thing, fear based approaches to motivating action are seriously
problematic, as they encourage community members to see members of those
other communities as enemies in a competition for contributor attention, rather
than as potential allies in the larger challenge of advancing the state of the
art in software development. It also has the effect of telling folks that enjoy
those other languages that they're not welcome in a community that views them
and their peers as "hostile competitors".&lt;/p&gt;
&lt;p&gt;In truth, we &lt;em&gt;want&lt;/em&gt; there to be a rich smorgasboard of cross platform open
source programming languages to choose from, as programming languages are first
and foremost &lt;em&gt;tools for thinking&lt;/em&gt; - they make it possible for us to convey our
ideas in terms so explicit that even a computer can understand them. If someone
has found a language to use that fits their brain and solves their immediate
problems, &lt;em&gt;that's great&lt;/em&gt;, regardless of the specific language (or languages)
they choose.&lt;/p&gt;
&lt;p&gt;So I have three specific requests for the Python community, and one broader
suggestion. First, the specific requests:&lt;/p&gt;
&lt;ol class="arabic simple"&gt;
&lt;li&gt;If we find it necessary to appeal to tribal instincts to motivate action, we
should avoid using tribal fear, and instead aim to use tribal pride.
When we use fear as a motivator, as in phrasings like "If we don't do X,
we're going to lose developer mindshare to language Y", we're deliberately
creating negative emotions in folks freely contributing the results of their
work to the world at large. Relying on tribal pride instead leads to
phrasings like "It's currently really unclear how to solve problem X in
Python. If we look to ecosystem Y, we can see they have a really nice
approach to solving problem X that we can potentially adapt to provide a
similarly nice user experience in Python". Actively emphasising taking pride
in our own efforts, rather than denigrating the efforts of others, helps
promote a culture of continuous learning within the Python community and
also encourages the development of ever improving collaborative
relationships with other communities.&lt;/li&gt;
&lt;li&gt;Refrain from adopting attitudes of contempt towards other open source
programming language communities, &lt;em&gt;especially&lt;/em&gt; if those communities have
empowered people to solve their own problems rather than having to wait for
commercial software vendors to deign to address them. Most of the important
problems in the world aren't profitable to solve (as the folks afflicted by
them aren't personally wealthy and don't control institutional funding
decisions), so we should be encouraging and applauding the folks stepping up
to try to solve them, regardless of what we may think of their technology
choices.&lt;/li&gt;
&lt;li&gt;If someone we know is learning to program for the first time, and they
choose to learn a language we don't personally like, we should &lt;em&gt;support them
in their choice anyway&lt;/em&gt;. They know what fits &lt;em&gt;their&lt;/em&gt; brain better than we do,
so the right language for us may not be the right language for them. If
they start getting frustrated with their original choice, to the point where
it's demotivating them from learning to program at all, &lt;em&gt;then&lt;/em&gt; it makes sense
to start recommending alternatives. This advice applies even for those of us
involved in improving the tragically bad state of network security: the way
we solve the problem with inherently insecure languages is by improving
operating system sandboxing capabilities, progressively knocking down
barriers to adoption for languages with better native security properties,
and improving the default behaviours of existing languages, not by confusing
beginners with arguments about why their chosen language is a poor choice
from an application security perspective. (If folks are deploying unaudited
software written by beginners to handle security sensitive tasks, it isn't
the folks &lt;em&gt;writing&lt;/em&gt; the software that are the problem, it's the folks
deploying it without performing appropriate due diligence on the provenance
and security properties of that software)&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;My broader suggestion is aimed at folks that are starting to encounter the
limits of the core procedural subset of Python and would hence like to start
exploring more of Python's own available "tools for thinking".&lt;/p&gt;
&lt;div class="section" id="broadening-our-horizons"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="http://www.curiousefficiency.org/posts/2015/10/languages-to-improve-your-python.html#id3"&gt;Broadening our horizons&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;One of the things we do as part of the Python core development process is to
look at features we appreciate having available in other languages we have
experience with, and see whether or not there is a way to adapt them to be
useful in making Python code easier to both read and write. This means that
learning another programming language that focuses more specifically on a
given style of software development can help improve &lt;em&gt;anyone's&lt;/em&gt; understanding
of that style of programming in the context of Python.&lt;/p&gt;
&lt;p&gt;To aid in such efforts, I've provided a list below of some possible areas for
exploration, and other languages which may provide additional insight into
those areas. Where possible, I've linked to Wikipedia pages rather than
directly to the relevant home pages, as Wikipedia often provides interesting
historical context that's worth exploring when picking up a new programming
language as an educational exercise rather than for immediate practical use.&lt;/p&gt;
&lt;p&gt;While I do know many of these languages personally (and have used several of
them in developing production systems), the full list of recommendations
includes additional languages that I only know indirectly (usually by either
reading tutorials and design documentation, or by talking to folks that I trust
to provide good insight into a language's strengths and weaknesses).&lt;/p&gt;
&lt;p&gt;There are a &lt;a class="reference external" href="https://github.com/mame/quine-relay"&gt;lot of other languages&lt;/a&gt; that could have gone on this list, so the
specific ones listed are a somewhat arbitrary subset based on my own interests
(for example, I'm mainly interested in the dominant Linux, Android and Windows
ecosystems, so I left out the niche-but-profitable Apple-centric Objective-C
and Swift programming languages, and I'm not familiar enough with art-focused
environments like &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Processing_%28programming_language%29"&gt;Processing&lt;/a&gt; to even guess at what learning them might teach
a Python developer). For a more complete list that takes into account factors
beyond what a language might teach you as a developer, IEEE Spectrum's
&lt;a class="reference external" href="http://spectrum.ieee.org/static/interactive-the-top-programming-languages-2015"&gt;annual ranking&lt;/a&gt; of programming language popularity and growth is well worth a
look.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="procedural-programming-c-rust-cython"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="http://www.curiousefficiency.org/posts/2015/10/languages-to-improve-your-python.html#id4"&gt;Procedural programming: C, Rust, Cython&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Python's default execution model is procedural: we start at the top of the main
module and execute it statement by statement. All of Python's support for the
other approaches to data and computational modelling covered below is built
on this procedural foundation.&lt;/p&gt;
&lt;p&gt;The &lt;a class="reference external" href="https://en.wikipedia.org/wiki/C_%28programming_language%29"&gt;C&lt;/a&gt; programming language is still the unchallenged ruler of low level
procedural programming. It's the core implementation language for the reference
Python interpreter, and also for the Linux operating system kernel. As a
software developer, learning C is one of the best ways to start learning more
about the underlying hardware that executes software applications - C is often
described as "portable assembly language", and one of the first applications
cross-compiled for any new CPU architecture will be a C compiler&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Rust_%28programming_language%29"&gt;Rust&lt;/a&gt;, by contrast, is a relatively new programming language created by
Mozilla. The reason it makes this list is because Rust aims to take all of the
lessons we've learned as an industry regarding what &lt;em&gt;not&lt;/em&gt; to do in C, and
design a new language that is interoperable with C libraries, offers the same
precise control over hardware usage that is needed in a low level systems
programming language, but uses a different compile time approach to data modelling
and memory management to structurally eliminate many of the common flaws
afflicting C programs (such as buffer overflows, double free errors, null
pointer access, and thread synchronisation problems). I'm an embedded systems
engineer by training and initial professional experience, and Rust is the first
new language I've seen that looks like it may have the potential to scale down
to all of the niches currently dominated by C and custom assembly code.&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Cython"&gt;Cython&lt;/a&gt; is also a lower level procedural-by-default language, but unlike
general purpose languages like C and Rust, Cython is aimed specifically at
writing CPython extension modules. To support that goal, Cython is designed as
a Python superset, allowing the programmer to choose when to favour the pure
Python syntax for flexibility, and when to favour Cython's syntax extensions
that make it possible to generate code that is equivalent to native C code in
terms of speed and memory efficiency.&lt;/p&gt;
&lt;p&gt;Learning one of these languages is likely to provide insight into memory
management, algorithmic efficiency, binary interface compatibility, software
portability, and other practical aspects of turning source code into running
systems.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="object-oriented-data-modelling-java-c-eiffel"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="http://www.curiousefficiency.org/posts/2015/10/languages-to-improve-your-python.html#id5"&gt;Object-oriented data modelling: Java, C#, Eiffel&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;One of the main things we need to do in programming is to model the state of
the real world, and offering native syntactic support for object-oriented
programming is one of the most popular approaches for doing that:
structurally grouping data structures, and methods for operating on those
data structures into classes.&lt;/p&gt;
&lt;p&gt;Python itself is deliberately designed so that it is possible to &lt;em&gt;use&lt;/em&gt; the
object-oriented features without first needing to learn to write your own
classes. Not every language adopts that approach - those listed in this section
are ones that consider learning object-oriented design to be a requirement for
using the language at all.&lt;/p&gt;
&lt;p&gt;After a major marketing push by Sun Microsystems in the mid-to-late 1990's,
&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Java_%28programming_language%29"&gt;Java&lt;/a&gt; became the default language for teaching introductory computer science
in many tertiary institutions. While it is now being displaced by Python for
many educational use cases, it remains one of the most popular languages for
the development of business applications. There are a range of other languages
that target the common JVM (Java Virtual Machine) runtime, including the
Jython implementation of Python. The Dalvik and ART environments for Android
systems are based on a reimplementation of the Java programming APIs.&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://en.wikipedia.org/wiki/C_Sharp_%28programming_language%29"&gt;C#&lt;/a&gt; is similar in many ways to Java, and emerged as an alternative after Sun
and Microsoft failed to work out their business differences around Microsoft's
Java implementation, &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Visual_J%2B%2B"&gt;J++&lt;/a&gt;. Like Java, it's a popular language for the
development of business applications, and there are a range of other languages
that target the shared .NET CLR (Common Language Runtime), including
the IronPython implementation of Python (the core components of the original
IronPython 1.0 implementation were extracted to create the language neutral
.NET Dynamic Language Runtime). For a long time, .NET was a proprietary Windows
specific technology, with &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Mono_%28software%29"&gt;mono&lt;/a&gt; as a cross-platform open source
reimplementation, but Microsoft shifted to an &lt;a class="reference external" href="http://radar.oreilly.com/2015/06/net-open-source.html"&gt;open source ecosystem strategy&lt;/a&gt;
in early 2015.&lt;/p&gt;
&lt;p&gt;Unlike most of the languages in this list, &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Eiffel_%28programming_language%29"&gt;Eiffel&lt;/a&gt; isn't one I'd recommend
for practical day-to-day use. Rather, it's one I recommend because learning it
taught &lt;em&gt;me&lt;/em&gt; an incredible amount about good object-oriented design where
"verifiably correct" is a design goal for the application. (Learning Eiffel also
taught me a lot about why "verifiably correct" isn't actually a design goal in
most software development, as verifiably correct software really doesn't cope
well with ambiguity and is entirely unsuitable for cases where you genuinely
don't know the relevant constraints yet and need to leave yourself enough
wiggle room to be able to figure out the finer details through iterative
development).&lt;/p&gt;
&lt;p&gt;Learning one of these languages is likely to provide insight into inheritance
models, design-by-contract, class invariants, pre-conditions, post-conditions,
covariance, contravariance, method resolution order, generic programming, and
various other notions that also apply to Python's type system. There are also
a number of standard library modules and third party frameworks that use this
"visibly object-oriented" design style, such as the &lt;tt class="docutils literal"&gt;unittest&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;logging&lt;/tt&gt;
modules, and class-based views in the &lt;tt class="docutils literal"&gt;Django&lt;/tt&gt; web framework.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="object-oriented-c-derivatives-c-d"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="http://www.curiousefficiency.org/posts/2015/10/languages-to-improve-your-python.html#id6"&gt;Object-oriented C derivatives: C++, D&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;One way of using the CPython runtime is as a "C with objects" programming
environment - at its core, CPython is implemented using C's approach to
object-oriented programming, which is to define C &lt;tt class="docutils literal"&gt;structs&lt;/tt&gt; to hold the data
of interest, and to pass in instances of the struct as the first argument to
functions that then manipulate that data (these are the omnipresent
&lt;tt class="docutils literal"&gt;PyObject*&lt;/tt&gt; pointers in the CPython C API). This design pattern is
deliberately mirrored at the Python level in the form of the explicit &lt;tt class="docutils literal"&gt;self&lt;/tt&gt;
and &lt;tt class="docutils literal"&gt;cls&lt;/tt&gt; arguments to instance methods and class methods.&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://en.wikipedia.org/wiki/C%2B%2B"&gt;C++&lt;/a&gt; is a programming language that aimed to retain full source compatibility
with &lt;tt class="docutils literal"&gt;C&lt;/tt&gt;, while adding higher level features like native object-oriented
programming support and template based metaprogramming. It's notoriously verbose
and hard to program in (although the 2011 update to the language standard
addressed many of the worst problems), but it's also the language of choice in
many contexts, including 3D modelling graphics engines and cross-platform
application development frameworks like Qt.&lt;/p&gt;
&lt;p&gt;The &lt;a class="reference external" href="https://en.wikipedia.org/wiki/D_%28programming_language%29"&gt;D&lt;/a&gt; programming language is also interesting, as it has a similar
relationship to C++ as Rust has to C: it aims to keep most of the desirable
characteristics of C++, while also avoiding many of its problems (like the lack
of memory safety). Unlike Rust, D was not a ground up design of a new
programming language from scratch - instead, D is a close derivative of C++,
and while it isn't a strict C superset as C++ is, it does follow the design
principle that any code that falls into the common subset of C and D must
behave the same way in both languages.&lt;/p&gt;
&lt;p&gt;Learning one of these languages is likely to provide insight into the
complexities of combining higher level language features with the underlying
C runtime model. Learning C++ is also likely to be useful when using Python
to manipulate existing libraries and toolkits written in C++.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="array-oriented-data-processing-matlab-octave-julia"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="http://www.curiousefficiency.org/posts/2015/10/languages-to-improve-your-python.html#id7"&gt;Array-oriented data processing: MATLAB/Octave, Julia&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Array oriented programming is designed to support numerical programming models:
those based on matrix algebra and related numerical methods.&lt;/p&gt;
&lt;p&gt;While Python's standard library doesn't support this directly, array oriented
programming &lt;em&gt;is&lt;/em&gt; taken into account in the language design, with a range of
syntactic and semantic features being added specifically for the benefit of
the third party &lt;a class="reference external" href="https://en.wikipedia.org/wiki/NumPy"&gt;NumPy&lt;/a&gt; library and similarly array-oriented tools.&lt;/p&gt;
&lt;p&gt;In many cases, the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/SciPy"&gt;Scientific Python&lt;/a&gt; stack is adopted as an alternative to
the proprietary &lt;a class="reference external" href="https://en.wikipedia.org/wiki/MATLAB"&gt;MATLAB&lt;/a&gt; programming environment, which is used extensively
for modelling, simulation and numerical data analysis in science and
engineering. &lt;a class="reference external" href="https://en.wikipedia.org/wiki/GNU_Octave"&gt;GNU Octave&lt;/a&gt; is an open source alternative that aims to be
syntactically compatible with MATLAB code, allowing folks to compare and
contrast the two approaches to array-oriented programming.&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Julia_%28programming_language%29"&gt;Julia&lt;/a&gt; is another relatively new language, which focuses heavily on array
oriented programming and type-based function overloading.&lt;/p&gt;
&lt;p&gt;Learning one of these languages is likely to provide insight into the
capabilities of the Scientific Python stack, as well as providing opportunities
to explore hardware level parallel execution through technologies like OpenCL
and Nvidia's CUDA, and distributed data processing through ecosystems like
&lt;a class="reference external" href="https://spark.apache.org/"&gt;Apache Spark&lt;/a&gt; and the Python-specific &lt;a class="reference external" href="http://blaze.pydata.org/"&gt;Blaze&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="statistical-data-analysis-r"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="http://www.curiousefficiency.org/posts/2015/10/languages-to-improve-your-python.html#id8"&gt;Statistical data analysis: R&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;As access to large data sets has grown, so has demand for capable freely
available analytical tools for processing those data sets. One such tool is
the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/R_%28programming_language%29"&gt;R&lt;/a&gt; programming language, which focuses specifically on statistical data
analysis and visualisation.&lt;/p&gt;
&lt;p&gt;Learning R is likely to provide insight into the statistical analysis
capabilities of the Scientific Python stack, especially the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Pandas_%28software%29"&gt;pandas&lt;/a&gt; data
manipulation library and the &lt;a class="reference external" href="http://stanford.edu/~mwaskom/software/seaborn/"&gt;seaborn&lt;/a&gt; statistical visualisation library.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="computational-pipeline-modelling-haskell-scala-clojure-f"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="http://www.curiousefficiency.org/posts/2015/10/languages-to-improve-your-python.html#id9"&gt;Computational pipeline modelling: Haskell, Scala, Clojure, F#&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Object-oriented data modelling and array-oriented data processing focus a lot
of attention on modelling data at rest, either in the form of collections of
named attributes or as arrays of structured data.&lt;/p&gt;
&lt;p&gt;By contrast, functional programming languages emphasise the modelling of data
in motion, in the form of computational flows. Learning at least the basics
of functional programming can help greatly improve the structure of data
transformation operations even in otherwise procedural, object-oriented or
array-oriented applications.&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Haskell_%28programming_language%29"&gt;Haskell&lt;/a&gt; is a functional programming language that has had a significant
influence on the design of Python, most notably through the introduction of
&lt;a class="reference external" href="https://docs.python.org/3/whatsnew/2.0.html#list-comprehensions"&gt;list comprehensions&lt;/a&gt; in Python 2.0.&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Scala_%28programming_language%29"&gt;Scala&lt;/a&gt; is an (arguably) functional programming language for the JVM that,
together with Java, Python and R, is one of the four primary programming
languages for the Apache Spark data analysis platform. While being designed to
encourage functional programming approaches, Scala's syntax, data model, and
execution model are also designed to minimise barriers to adoption for current
Java programmers (hence the "arguably" - the case can be made that Scala is
better categorised as an object-oriented programming language with strong
functional programming support).&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Clojure"&gt;Clojure&lt;/a&gt; is another functional programming language for the JVM that is
designed as a dialect of &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Lisp_%28programming_language%29"&gt;Lisp&lt;/a&gt;. It earns its place in this list by being
the inspiration for the &lt;a class="reference external" href="https://toolz.readthedocs.org/en/latest/heritage.html"&gt;toolz&lt;/a&gt; functional programming toolkit for Python.&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://en.wikipedia.org/wiki/F_Sharp_%28programming_language%29"&gt;F#&lt;/a&gt; isn't a language I'm particularly familiar with myself, but seems worth
noting as the preferred functional programming language for the .NET CLR.&lt;/p&gt;
&lt;p&gt;Learning one of these languages is likely to provide insight into Python's own
computational pipeline modelling tools, including container comprehensions,
generators, generator expressions, the &lt;tt class="docutils literal"&gt;functools&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;itertools&lt;/tt&gt; standard
library modules, and third party functional Python toolkits like &lt;a class="reference external" href="https://toolz.readthedocs.org/en/latest/heritage.html"&gt;toolz&lt;/a&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="event-driven-programming-javascript-go-erlang-elixir"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="http://www.curiousefficiency.org/posts/2015/10/languages-to-improve-your-python.html#id10"&gt;Event driven programming: JavaScript, Go, Erlang, Elixir&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Computational pipelines are an excellent way to handle data transformation and
analysis problems, but many problems require that an application run as a
persistent service that &lt;em&gt;waits&lt;/em&gt; for events to occur, and then &lt;em&gt;handles&lt;/em&gt; those
events. In these kinds of services, it is usually essential to be able to handle
multiple events concurrently in order to be able to accommodate multiple users
(or at least multiple actions) at the same time.&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://en.wikipedia.org/wiki/JavaScript"&gt;JavaScript&lt;/a&gt; was originally developed as an event handling language for web
browsers, permitting website developers to respond locally to client side
actions (such as mouse clicks and key presses) and events (such as the page
rendering being completed). It is supported in all modern browsers, and
together with the HTML5 Domain Object Model, has become a de facto standard
for defining the appearance and behaviour of user interfaces.&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Go_%28programming_language%29"&gt;Go&lt;/a&gt; was designed by Google as a purpose built language for creating highly
scalable web services, and has also proven to be a very capable language for
developing command line applications. The most interesting aspect of Go from
a programming language design perspective is its use of &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Communicating_sequential_processes"&gt;Communicating
Sequential Processes&lt;/a&gt; concepts in its core concurrency model.&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Erlang_%28programming_language%29"&gt;Erlang&lt;/a&gt; was designed by Ericsson as a purpose built language for creating
highly reliable telephony switches and similar devices, and is the language
powering the popular &lt;a class="reference external" href="https://en.wikipedia.org/wiki/RabbitMQ"&gt;RabbitMQ&lt;/a&gt; message broker. Erlang uses the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Actor_model"&gt;Actor model&lt;/a&gt;
as its core concurrency primitive, passing messages between threads of
execution, rather than allowing them to share data directly. While I've never
programmed in Erlang myself, my first full-time job involved working with (and
on) an Actor-based concurrency framework for C++ developed by an ex-Ericsson
engineer, as well as developing such a framework myself based on the TSK (Task)
and MBX (Mailbox) primitives in Texas Instrument's lightweight &lt;a class="reference external" href="https://en.wikipedia.org/wiki/TI-RTOS"&gt;DSP/BIOS&lt;/a&gt;
runtime (now known as TI-RTOS).&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Elixir_%28programming_language%29"&gt;Elixir&lt;/a&gt; earns an entry on the list by being a language designed to run on the
Erlang VM that exposes the same concurrency semantics as Erlang, while also
providing a range of additional language level features to help provide a more
well-rounded environment that is more likely to appeal to developers migrating
from other languages like Python, Java, or Ruby.&lt;/p&gt;
&lt;p&gt;Learning one of these languages is likely to provide insight into Python's own
concurrency and parallelism support, including native coroutines, generator
based coroutines, the &lt;tt class="docutils literal"&gt;concurrent.futures&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;asyncio&lt;/tt&gt; standard
library modules, third party network service development frameworks like
&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Twisted_%28software%29"&gt;Twisted&lt;/a&gt; and &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Tornado_%28web_server%29"&gt;Tornado&lt;/a&gt;, the &lt;a class="reference external" href="http://channels.readthedocs.org/en/latest/concepts.html"&gt;channels&lt;/a&gt; concept being introduced to Django,
and the event handling loops in GUI frameworks.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="gradual-typing-typescript"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="http://www.curiousefficiency.org/posts/2015/10/languages-to-improve-your-python.html#id11"&gt;Gradual typing: TypeScript&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;One of the more controversial features that landed in Python 3.5 was the new
&lt;tt class="docutils literal"&gt;typing&lt;/tt&gt; module, which brings a standard lexicon for gradual typing support
to the Python ecosystem.&lt;/p&gt;
&lt;p&gt;For folks whose primary exposure to static typing is in languages like C,
C++ and Java, this seems like an astoundingly terrible idea (hence the
controversy).&lt;/p&gt;
&lt;p&gt;Microsoft's &lt;a class="reference external" href="https://en.wikipedia.org/wiki/TypeScript"&gt;TypeScript&lt;/a&gt;, which provides gradual typing for JavaScript
applications provides a better illustration of the concept. TypeScript code
compiles to JavaScript code (which then doesn't include any runtime type
checking), and TypeScript annotations for popular JavaScript libraries are
maintained in the dedicated &lt;a class="reference external" href="http://definitelytyped.org/"&gt;DefinitelyTyped&lt;/a&gt; repository.&lt;/p&gt;
&lt;p&gt;As Chris Neugebauer pointed out in his &lt;a class="reference external" href="https://www.youtube.com/watch?v=_PPQLeimyOM"&gt;PyCon Australia presentation&lt;/a&gt;, this is
very similar to the proposed relationship between Python, the &lt;a class="reference external" href="https://github.com/python/typeshed"&gt;typeshed&lt;/a&gt; type
hint repository, and type inference and analysis tools like &lt;a class="reference external" href="http://mypy-lang.org/"&gt;mypy&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;In essence, both TypeScript and type hinting in Python are ways of writing
particular kinds of tests, either as separate files (just like normal tests),
or inline with the main body of the code (just like type declarations in
statically typed languages). In either case, you run a &lt;em&gt;separate&lt;/em&gt; command to
actually check that the rest of the code is consistent with the available type
assertions (this occurs implicitly as part of the compilation to JavaScript for
TypeScript, and as an entirely optional static analysis task for Python's type
hinting).&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="dynamic-metaprogramming-hy-ruby"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="http://www.curiousefficiency.org/posts/2015/10/languages-to-improve-your-python.html#id12"&gt;Dynamic metaprogramming: Hy, Ruby&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;A feature folks coming to Python from languages like C, C++, C# and Java often
find disconcerting is the notion that "code is data": the fact that things like
functions and classes are runtime objects that can be manipulated like any
other object.&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Hy"&gt;Hy&lt;/a&gt; is a Lisp dialect that runs on both the CPython VM and the PyPy VM. Lisp
dialects take the "code as data" concept to extremes, as Lisp code consists of
nested lists describing the operations to be performed (the name of the language
itself stands for "LISt Processor"). The great strength of Lisp-style languages
is that they make it incredibly easy to write your own domain specific
languages. The great weakness of Lisp-style languages is that they make it
incredibly easy to write your own domain specific languages, which can sometimes
make it difficult to read other people's code.&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Ruby_%28programming_language%29"&gt;Ruby&lt;/a&gt; is a language that is similar to Python in many respects, but as a
community is far more open to making use of dynamic metaprogramming features
that are "supported, but not encouraged" in Python. This includes things like
reopening class definitions to add additional methods, and using closures to
implement core language constructs like iteration.&lt;/p&gt;
&lt;p&gt;Learning one of these languages is likely to provide insight into Python's own
dynamic metaprogramming support, including function and class decorators,
&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Monkey_patch"&gt;monkeypatching&lt;/a&gt;, the &lt;tt class="docutils literal"&gt;unittest.mock&lt;/tt&gt; standard library module, and third
party object proxying modules like &lt;a class="reference external" href="http://wrapt.readthedocs.org/en/latest/"&gt;wrapt&lt;/a&gt;. (I'm not aware of any languages to
learn that are likely to provide insight into Python's metaclass system, so if
anyone has any suggestions on that front, please mention them in the comments.
Metaclasses power features like the core type system, abstract base classes,
enumeration types and runtime evaluation of gradual typing expressions)&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="pragmatic-problem-solving-lua-php-perl"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="http://www.curiousefficiency.org/posts/2015/10/languages-to-improve-your-python.html#id13"&gt;Pragmatic problem solving: Lua, PHP, Perl&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Popular programming languages don't exist in isolation - they exist as part of
larger ecosystems of redistributors (both commercial and community focused),
end users, framework developers, tool developers, educators and more.&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://en.wikipedia.org/wiki/Lua_%28programming_language%29"&gt;Lua&lt;/a&gt; is a popular programming language for embedding in larger applications
as a scripting engine. Significant examples include it being the language
used to write add-ons for the World of Warcraft game client, and it's also
embedded in the RPM utility used by many Linux distributions. Compared to
CPython, a Lua runtime will generally be a tenth of the size, and its weaker
introspection capabilities generally make it easier to isolate from the rest of
the application and the host operating system. A notable contribution from the
Lua community to the Python ecosystem is the adoption of the LuaJIT FFI
(Foreign Function Interface) as the basis of the JIT-friendly &lt;a class="reference external" href="https://cffi.readthedocs.org/en/latest/#goals"&gt;cffi&lt;/a&gt; interface
library for CPython and PyPy.&lt;/p&gt;
&lt;p&gt;&lt;a class="reference external" href="https://en.wikipedia.org/wiki/PHP"&gt;PHP&lt;/a&gt; is another popular programming language that rose to prominence as the
original "P" in the Linux-Apache-MySQL-PHP &lt;a class="reference external" href="https://en.wikipedia.org/wiki/LAMP_%28software_bundle%29"&gt;LAMP stack&lt;/a&gt;, due to its focus on
producing HTML pages, and its broad availability on early Virtual Private
Server hosting providers. For all the handwringing about conceptual flaws in
various aspects of its design, it's now the basis of several widely popular
open source web services, including the Drupal content management system, the
Wordpress blogging engine, and the MediaWiki engine that powers Wikipedia. PHP
also powers important services like the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Ushahidi"&gt;Ushahidi&lt;/a&gt; platform for crowdsourced
community reporting on distributed events.&lt;/p&gt;
&lt;p&gt;Like PHP, &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Perl"&gt;Perl&lt;/a&gt; rose to popularity on the back of Linux. Unlike PHP, which
grew specifically as a web development platform, Perl rose to prominence as
a system administrator's tool, using regular expressions to string together
and manipulate the output of text-based Linux operating system commands. When
&lt;tt class="docutils literal"&gt;sh&lt;/tt&gt;, &lt;tt class="docutils literal"&gt;awk&lt;/tt&gt; and &lt;tt class="docutils literal"&gt;sed&lt;/tt&gt; were no longer up to handling a task, Perl was there
to take over.&lt;/p&gt;
&lt;p&gt;Learning one of these languages isn't likely to provide any great insight into
aesthetically beautiful or conceptually elegant programming language design.
What it &lt;em&gt;is&lt;/em&gt; likely to do is to provide some insight into how programming
language distribution and adoption works in practice, and how much that has to
do with fortuitous opportunities, accidents of history and lowering barriers to
adoption by working with redistributors to be made available by default, rather
than the inherent capabilities of the languages themselves.&lt;/p&gt;
&lt;p&gt;In particular, it may provide insight into the significance of projects like
&lt;a class="reference external" href="http://ckan.org/instances/#"&gt;CKAN&lt;/a&gt;, &lt;a class="reference external" href="https://wiki.openstack.org/wiki/TelcoWorkingGroup"&gt;OpenStack NFV&lt;/a&gt;, &lt;a class="reference external" href="https://www.blender.org/"&gt;Blender&lt;/a&gt;, &lt;a class="reference external" href="http://www.scipy.org/"&gt;SciPy&lt;/a&gt;, &lt;a class="reference external" href="http://openmdao.org/"&gt;OpenMDAO&lt;/a&gt;, &lt;a class="reference external" href="http://esa.github.io/pygmo/"&gt;PyGMO&lt;/a&gt;,
&lt;a class="reference external" href="https://developer.nvidia.com/pycuda"&gt;PyCUDA&lt;/a&gt;, the &lt;a class="reference external" href="https://www.raspberrypi.org/"&gt;Raspberry Pi Foundation&lt;/a&gt; and Python's adoption by a
&lt;a class="reference external" href="https://us.pycon.org/2015/sponsors/"&gt;wide range of commercial organisations&lt;/a&gt;, for securing ongoing
institutional investment in the Python ecosystem.&lt;/p&gt;
&lt;/div&gt;
&lt;div class="section" id="computational-thinking-scratch-logo"&gt;
&lt;h2&gt;&lt;a class="toc-backref" href="http://www.curiousefficiency.org/posts/2015/10/languages-to-improve-your-python.html#id14"&gt;Computational thinking: Scratch, Logo&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;Finally, I fairly regularly get into discussions with functional and
object-oriented programming advocates claiming that those kinds of languages
are just as easy to learn as procedural ones.&lt;/p&gt;
&lt;p&gt;I think the OOP folks have a point if we're talking about teaching through
embodied computing (e.g. robotics), where the objects being modelled in
software have direct real world counterparts the students can touch, like
sensors, motors, and relays.&lt;/p&gt;
&lt;p&gt;For everyone else though, I now have a standard challenge: pick up a cookbook,
translate one of the recipes into the programming language you're claiming is
easy to learn, and then get a student that understands the language the
original cookbook was written in to follow the translated recipe. Most of the
time folks don't need to actually follow through on this - just running it
as a thought experiment is enough to help them realise how much prior knowledge
their claim of "it's easy to learn" is assuming. (I'd love to see academic
researchers perform this kind of study for real though - I'd be genuinely
fascinated to read the results)&lt;/p&gt;
&lt;p&gt;Another way to tackle this problem though is to go learn the languages that
are actually being used to start teaching computational thinking to children.&lt;/p&gt;
&lt;p&gt;One of the most popular of those is &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Scratch_%28programming_language%29"&gt;Scratch&lt;/a&gt;, which uses a drag-and-drop
programming interface to let students manipulate a self-contained graphical
environment, with sprites moving around and reacting to events in that
environment. Graphical environments like Scratch are the programming
equivalent of the picture books we use to help introduce children to reading
and writing.&lt;/p&gt;
&lt;p&gt;This idea of using a special purpose educational language to manipulate a
graphical environment isn't new though, with one of the earliest incarnations
being the &lt;a class="reference external" href="https://en.wikipedia.org/wiki/Logo_%28programming_language%29"&gt;Logo&lt;/a&gt; environment created back in the 1960's. In Logo (and similar
environments like Python's own &lt;tt class="docutils literal"&gt;turtle&lt;/tt&gt; module), the main thing you're
interacting with is a "turtle", which you can instruct to move around and
modify its environment by drawing lines. This way, concepts like command
sequences, repetition, and state (e.g. "pen up", "pen down") can be introduced
in a way that builds on people's natural intuitions ("imagine you're the turtle,
what's going to happen if you turn right 90 degrees?")&lt;/p&gt;
&lt;p&gt;Going back and relearning one of these languages as an experienced programmer
is most useful as a tool for unlearning: the concepts they introduce help
remind us that these are concepts that we take for granted now, but needed to
learn at some point as beginners. When we do that, we're better able to work
effectively with students and other newcomers, as we're more likely to
remember to unpack our chains of logic, including the steps we'd otherwise take
for granted.&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;</description><category>python</category><guid>http://www.curiousefficiency.org/posts/2015/10/languages-to-improve-your-python.html</guid><pubDate>Sun, 11 Oct 2015 02:54:39 GMT</pubDate></item><item><title>TCP echo client and server in Python 3.5</title><link>http://www.curiousefficiency.org/posts/2015/07/asyncio-tcp-echo-server.html</link><dc:creator>Nick Coghlan</dc:creator><description>&lt;div&gt;&lt;p&gt;This is a follow-on from my
&lt;a href="http://www.curiousefficiency.org/posts/2015/07/asyncio-background-calls.html"&gt;previous post&lt;/a&gt;
on Python 3.5's new &lt;code&gt;async&lt;/code&gt;/&lt;code&gt;await&lt;/code&gt; syntax. Rather than the simple background
timers used in the original post, this one will look at the impact native
coroutine support has on the TCP echo client and server examples from the
&lt;a href="https://docs.python.org/3.4/library/asyncio-stream.html#tcp-echo-client-using-streams"&gt;asyncio documentation&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;First, we'll recreate the &lt;code&gt;run_in_foreground&lt;/code&gt; helper defined in the previous
post. This helper function makes it easier to work with coroutines from
otherwise synchronous code (like the interactive prompt):&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;run_in_foreground&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;task&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;loop&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;"""Runs event loop in current thread until the given task completes&lt;/span&gt;

&lt;span class="sd"&gt;    Returns the result of the task.&lt;/span&gt;
&lt;span class="sd"&gt;    For more complex conditions, combine with asyncio.wait()&lt;/span&gt;
&lt;span class="sd"&gt;    To include a timeout, combine with asyncio.wait_for()&lt;/span&gt;
&lt;span class="sd"&gt;    """&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;loop&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;loop&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;asyncio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_event_loop&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;loop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;run_until_complete&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;asyncio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ensure_future&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;task&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;loop&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;loop&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;


&lt;p&gt;Next we'll define the coroutine for our TCP echo server implementation,
which simply waits to receive up to 100 bytes on each new client connection,
and then sends that data back to the client:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="n"&gt;async&lt;/span&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;handle_tcp_echo&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;reader&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;writer&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;reader&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;message&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;decode&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="n"&gt;addr&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;writer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_extra_info&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'peername'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"-&amp;gt; Server received &lt;/span&gt;&lt;span class="si"&gt;%r&lt;/span&gt;&lt;span class="s"&gt; from &lt;/span&gt;&lt;span class="si"&gt;%r&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;addr&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"&amp;lt;- Server sending: &lt;/span&gt;&lt;span class="si"&gt;%r&lt;/span&gt;&lt;span class="s"&gt;"&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;writer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;writer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;drain&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"-- Terminating connection on server"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;writer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;/pre&gt;


&lt;p&gt;And then the client coroutine we'll use to send a message and wait for a
response:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="n"&gt;async&lt;/span&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;tcp_echo_client&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;port&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;loop&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;reader&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;writer&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;asyncio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;open_connection&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'127.0.0.1'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;port&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt;
                                                        &lt;span class="n"&gt;loop&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;loop&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'-&amp;gt; Client sending: &lt;/span&gt;&lt;span class="si"&gt;%r&lt;/span&gt;&lt;span class="s"&gt;'&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;writer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;write&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;encode&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
    &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;reader&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;read&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;decode&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'&amp;lt;- Client received: &lt;/span&gt;&lt;span class="si"&gt;%r&lt;/span&gt;&lt;span class="s"&gt;'&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'-- Terminating connection on client'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;writer&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;
&lt;/pre&gt;


&lt;p&gt;We then use our &lt;code&gt;run_in_foreground&lt;/code&gt; helper to interact with these coroutines
from the interactive prompt. First, we start the echo server:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;make_server&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;asyncio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;start_server&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;handle_tcp_echo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;'127.0.0.1'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;server&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;run_in_foreground&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;make_server&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;


&lt;p&gt;Conveniently, since this is a coroutine running in the &lt;em&gt;current&lt;/em&gt; thread, rather
than in a different thread, we can retrieve the details of the listening
socket immediately, including the automatically assigned port number:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;server&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sockets&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="go"&gt;&amp;lt;socket.socket fd=6, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('127.0.0.1', 40796)&amp;gt;&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;port&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;server&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sockets&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getsockname&lt;/span&gt;&lt;span class="p"&gt;()[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;


&lt;p&gt;Since we haven't needed to hardcode the port number, if we want to define a
second server, we can easily do that as well:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;make_server2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;asyncio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;start_server&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;handle_tcp_echo&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;'127.0.0.1'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;server2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;run_in_foreground&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;make_server2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;server2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sockets&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;span class="go"&gt;&amp;lt;socket.socket fd=7, family=AddressFamily.AF_INET, type=2049, proto=6, laddr=('127.0.0.1', 41200)&amp;gt;&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;port2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;server2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sockets&lt;/span&gt;&lt;span class="p"&gt;[&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;getsockname&lt;/span&gt;&lt;span class="p"&gt;()[&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;]&lt;/span&gt;
&lt;/pre&gt;


&lt;p&gt;Now, both of these servers are configured to run directly in the main thread's
event loop, so trying to talk to them using a synchronous client wouldn't work.
The client would block the main thread, and the servers wouldn't be able to
process incoming connections. That's where our asynchronous client coroutine
comes in: if we use &lt;em&gt;that&lt;/em&gt; to send messages to the server, then it doesn't
block the main thread either, and both the client and server coroutines can
process incoming events of interest. That gives the following results:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;run_in_foreground&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tcp_echo_client&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'Hello World!'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;port&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;span class="go"&gt;-&amp;gt; Client sending: 'Hello World!'&lt;/span&gt;
&lt;span class="go"&gt;-&amp;gt; Server received 'Hello World!' from ('127.0.0.1', 44386)&lt;/span&gt;
&lt;span class="go"&gt;&amp;lt;- Server sending: 'Hello World!'&lt;/span&gt;
&lt;span class="go"&gt;-- Terminating connection on server&lt;/span&gt;
&lt;span class="go"&gt;&amp;lt;- Client received: 'Hello World!'&lt;/span&gt;
&lt;span class="go"&gt;-- Terminating connection on client&lt;/span&gt;
&lt;span class="go"&gt;Hello World!&lt;/span&gt;
&lt;/pre&gt;


&lt;p&gt;Note something important here: you will get &lt;em&gt;exactly&lt;/em&gt; that sequence of
output messages, as this is &lt;em&gt;all&lt;/em&gt; running in the interpreter's main thread, in
a deterministic order. If the servers were running in their own threads, we
wouldn't have that property (and reliably getting access to the port numbers
the server components were assigned by the underlying operating system would
also have been far more difficult).&lt;/p&gt;
&lt;p&gt;And to demonstrate both servers are up and running:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;run_in_foreground&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tcp_echo_client&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'Hello World!'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;port2&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;span class="go"&gt;-&amp;gt; Client sending: 'Hello World!'&lt;/span&gt;
&lt;span class="go"&gt;-&amp;gt; Server received 'Hello World!' from ('127.0.0.1', 44419)&lt;/span&gt;
&lt;span class="go"&gt;&amp;lt;- Server sending: 'Hello World!'&lt;/span&gt;
&lt;span class="go"&gt;-- Terminating connection on server&lt;/span&gt;
&lt;span class="go"&gt;&amp;lt;- Client received: 'Hello World!'&lt;/span&gt;
&lt;span class="go"&gt;-- Terminating connection on client&lt;/span&gt;
&lt;span class="go"&gt;Hello World!&lt;/span&gt;
&lt;/pre&gt;


&lt;p&gt;That then raises an interesting question: how would we send messages to the
two servers in parallel, while still only using a single thread to manage the
client and server coroutines? For that, we'll need another of our helper
functions from the previous post, &lt;code&gt;schedule_coroutine&lt;/code&gt;:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;schedule_coroutine&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;loop&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;"""Schedules target coroutine in the given event loop&lt;/span&gt;

&lt;span class="sd"&gt;    If not given, *loop* defaults to the current thread's event loop&lt;/span&gt;

&lt;span class="sd"&gt;    Returns the scheduled task.&lt;/span&gt;
&lt;span class="sd"&gt;    """&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;asyncio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;iscoroutine&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;asyncio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ensure_future&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;loop&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;loop&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;raise&lt;/span&gt; &lt;span class="ne"&gt;TypeError&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"target must be a coroutine, "&lt;/span&gt;
                    &lt;span class="s"&gt;"not {!r}"&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;/pre&gt;


&lt;p&gt;&lt;strong&gt;Update:&lt;/strong&gt; &lt;em&gt;As with the previous post, this post originally suggested a
combined "run_in_background" helper function that handled both scheduling
coroutines and calling arbitrary callables in a background thread or process.
On further reflection, I decided that was unhelpfully conflating two different
concepts, so I replaced it with separate "schedule_coroutine" and
"call_in_background" helpers&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;First, we set up the two client operations we want to run in parallel:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;echo1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;schedule_coroutine&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tcp_echo_client&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'Hello World!'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;port&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;echo2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;schedule_coroutine&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tcp_echo_client&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'Hello World!'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;port2&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;


&lt;p&gt;Then we use the &lt;code&gt;asyncio.wait&lt;/code&gt; function in combination with &lt;code&gt;run_in_foreground&lt;/code&gt;
to run the event loop until both operations are complete:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;run_in_foreground&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;asyncio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wait&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;echo1&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;echo2&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;span class="go"&gt;-&amp;gt; Client sending: 'Hello World!'&lt;/span&gt;
&lt;span class="go"&gt;-&amp;gt; Client sending: 'Hello World!'&lt;/span&gt;
&lt;span class="go"&gt;-&amp;gt; Server received 'Hello World!' from ('127.0.0.1', 44461)&lt;/span&gt;
&lt;span class="go"&gt;&amp;lt;- Server sending: 'Hello World!'&lt;/span&gt;
&lt;span class="go"&gt;-- Terminating connection on server&lt;/span&gt;
&lt;span class="go"&gt;-&amp;gt; Server received 'Hello World!' from ('127.0.0.1', 44462)&lt;/span&gt;
&lt;span class="go"&gt;&amp;lt;- Server sending: 'Hello World!'&lt;/span&gt;
&lt;span class="go"&gt;-- Terminating connection on server&lt;/span&gt;
&lt;span class="go"&gt;&amp;lt;- Client received: 'Hello World!'&lt;/span&gt;
&lt;span class="go"&gt;-- Terminating connection on client&lt;/span&gt;
&lt;span class="go"&gt;&amp;lt;- Client received: 'Hello World!'&lt;/span&gt;
&lt;span class="go"&gt;-- Terminating connection on client&lt;/span&gt;
&lt;span class="go"&gt;({&amp;lt;Task finished coro=&amp;lt;tcp_echo_client() done, defined at &amp;lt;stdin&amp;gt;:1&amp;gt; result='Hello World!'&amp;gt;, &amp;lt;Task finished coro=&amp;lt;tcp_echo_client() done, defined at &amp;lt;stdin&amp;gt;:1&amp;gt; result='Hello World!'&amp;gt;}, set())&lt;/span&gt;
&lt;/pre&gt;


&lt;p&gt;And finally, we retrieve our results using the &lt;code&gt;result&lt;/code&gt; method of the task
objects returned by &lt;code&gt;schedule_coroutine&lt;/code&gt;:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;echo1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="go"&gt;'Hello World!'&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;echo2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="go"&gt;'Hello World!'&lt;/span&gt;
&lt;/pre&gt;


&lt;p&gt;We can set up as many concurrent background tasks as we like, and then use
&lt;code&gt;asyncio.wait&lt;/code&gt; as the foreground task to wait for them all to complete.&lt;/p&gt;
&lt;p&gt;But what if we had an existing blocking client function that we wanted or
needed to use (e.g. we're using an &lt;code&gt;asyncio&lt;/code&gt; server to test a synchronous
client API). To handle that case, we use our third helper function from the
previous post:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;call_in_background&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;loop&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;executor&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;"""Schedules and starts target callable as a background task&lt;/span&gt;

&lt;span class="sd"&gt;    If not given, *loop* defaults to the current thread's event loop&lt;/span&gt;
&lt;span class="sd"&gt;    If not given, *executor* defaults to the loop's default executor&lt;/span&gt;

&lt;span class="sd"&gt;    Returns the scheduled task.&lt;/span&gt;
&lt;span class="sd"&gt;    """&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;loop&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;loop&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;asyncio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_event_loop&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;callable&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;loop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;run_in_executor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;executor&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;raise&lt;/span&gt; &lt;span class="ne"&gt;TypeError&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"target must be a callable, "&lt;/span&gt;
                    &lt;span class="s"&gt;"not {!r}"&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;/pre&gt;


&lt;p&gt;To explore this, we'll need a blocking client, which we can build based on
Python's existing
&lt;a href="https://docs.python.org/3/howto/sockets.html"&gt;socket programming HOWTO guide&lt;/a&gt;:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;socket&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;tcp_echo_client_sync&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;port&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="n"&gt;conn&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;AF_INET&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;socket&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;SOCK_STREAM&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'-&amp;gt; Client connecting to port: &lt;/span&gt;&lt;span class="si"&gt;%r&lt;/span&gt;&lt;span class="s"&gt;'&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;port&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;connect&lt;/span&gt;&lt;span class="p"&gt;((&lt;/span&gt;&lt;span class="s"&gt;'127.0.0.1'&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;port&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'-&amp;gt; Client sending: &lt;/span&gt;&lt;span class="si"&gt;%r&lt;/span&gt;&lt;span class="s"&gt;'&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;send&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;message&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;encode&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
    &lt;span class="n"&gt;data&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;recv&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;100&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;decode&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'&amp;lt;- Client received: &lt;/span&gt;&lt;span class="si"&gt;%r&lt;/span&gt;&lt;span class="s"&gt;'&lt;/span&gt; &lt;span class="o"&gt;%&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;'-- Terminating connection on client'&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="n"&gt;conn&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;close&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;data&lt;/span&gt;
&lt;/pre&gt;


&lt;p&gt;We can then use &lt;code&gt;functools.partial&lt;/code&gt; in combination with &lt;code&gt;call_in_background&lt;/code&gt; to
start client requests in multiple operating system level threads:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;query_server&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;partial&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tcp_echo_client_sync&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;"Hello World!"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;port&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;query_server2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;partial&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tcp_echo_client_sync&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="s"&gt;"Hello World!"&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;port2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;bg_call&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;call_in_background&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;query_server&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="go"&gt;-&amp;gt; Client connecting to port: 35876&lt;/span&gt;
&lt;span class="go"&gt;-&amp;gt; Client sending: 'Hello World!'&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;bg_call2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;call_in_background&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;query_server2&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="go"&gt;-&amp;gt; Client connecting to port: 41672&lt;/span&gt;
&lt;span class="go"&gt;-&amp;gt; Client sending: 'Hello World!'&lt;/span&gt;
&lt;/pre&gt;


&lt;p&gt;Here we see that, unlike our coroutine clients, the synchronous clients have
started running immediately in a separate thread. However, because the event
loop isn't currently running in the main thread, they've blocked waiting for
a response from the TCP echo servers. As with the coroutine clients, we
address that by running the event loop in the main thread until our clients
have both received responses:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;run_in_foreground&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;asyncio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;wait&lt;/span&gt;&lt;span class="p"&gt;([&lt;/span&gt;&lt;span class="n"&gt;bg_call&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;bg_call2&lt;/span&gt;&lt;span class="p"&gt;]))&lt;/span&gt;
&lt;span class="go"&gt;-&amp;gt; Server received 'Hello World!' from ('127.0.0.1', 52585)&lt;/span&gt;
&lt;span class="go"&gt;&amp;lt;- Server sending: 'Hello World!'&lt;/span&gt;
&lt;span class="go"&gt;-- Terminating connection on server&lt;/span&gt;
&lt;span class="go"&gt;-&amp;gt; Server received 'Hello World!' from ('127.0.0.1', 34399)&lt;/span&gt;
&lt;span class="go"&gt;&amp;lt;- Server sending: 'Hello World!'&lt;/span&gt;
&lt;span class="go"&gt;&amp;lt;- Client received: 'Hello World!'&lt;/span&gt;
&lt;span class="go"&gt;-- Terminating connection on server&lt;/span&gt;
&lt;span class="go"&gt;-- Terminating connection on client&lt;/span&gt;
&lt;span class="go"&gt;&amp;lt;- Client received: 'Hello World!'&lt;/span&gt;
&lt;span class="go"&gt;-- Terminating connection on client&lt;/span&gt;
&lt;span class="go"&gt;({&amp;lt;Future finished result='Hello World!'&amp;gt;, &amp;lt;Future finished result='Hello World!'&amp;gt;}, set())&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;bg_call&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="go"&gt;'Hello World!'&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;bg_call2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;result&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="go"&gt;'Hello World!'&lt;/span&gt;
&lt;/pre&gt;&lt;/div&gt;</description><category>python</category><guid>http://www.curiousefficiency.org/posts/2015/07/asyncio-tcp-echo-server.html</guid><pubDate>Sat, 11 Jul 2015 06:31:44 GMT</pubDate></item><item><title>Background tasks in Python 3.5</title><link>http://www.curiousefficiency.org/posts/2015/07/asyncio-background-calls.html</link><dc:creator>Nick Coghlan</dc:creator><description>&lt;div&gt;&lt;p&gt;One of the recurring questions with asyncio is "How do I execute one or two
operations asynchronously in an otherwise synchronous application?"&lt;/p&gt;
&lt;p&gt;Say, for example, I have the following code:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;itertools&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nn"&gt;time&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;ticker&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;itertools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;count&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;        &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;        &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="gp"&gt;...&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;ticker&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="go"&gt;0&lt;/span&gt;
&lt;span class="go"&gt;1&lt;/span&gt;
&lt;span class="go"&gt;2&lt;/span&gt;
&lt;span class="go"&gt;3&lt;/span&gt;
&lt;span class="go"&gt;^CTraceback (most recent call last):&lt;/span&gt;
&lt;span class="go"&gt; File "&amp;lt;stdin&amp;gt;", line 1, in &amp;lt;module&amp;gt;&lt;/span&gt;
&lt;span class="go"&gt; File "&amp;lt;stdin&amp;gt;", line 4, in ticker&lt;/span&gt;
&lt;span class="nc"&gt;KeyboardInterrupt&lt;/span&gt;
&lt;/pre&gt;


&lt;p&gt;With the native coroutine syntax coming in Python 3.5, I can change that
synchronous code into event-driven asynchronous code easily enough:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;asyncio&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nn"&gt;itertools&lt;/span&gt;
&lt;span class="n"&gt;async&lt;/span&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;ticker&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;itertools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;count&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;asyncio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;


&lt;p&gt;But how do I arrange for that ticker to start running in the background? What's
the coroutine equivalent of appending &lt;code&gt;&amp;amp;&lt;/code&gt; to a shell command?&lt;/p&gt;
&lt;p&gt;It turns out it looks something like this:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;asyncio&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;schedule_coroutine&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;loop&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;"""Schedules target coroutine in the given event loop&lt;/span&gt;

&lt;span class="sd"&gt;    If not given, *loop* defaults to the current thread's event loop&lt;/span&gt;

&lt;span class="sd"&gt;    Returns the scheduled task.&lt;/span&gt;
&lt;span class="sd"&gt;    """&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;asyncio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;iscoroutine&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;asyncio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ensure_future&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;loop&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;loop&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;raise&lt;/span&gt; &lt;span class="ne"&gt;TypeError&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"target must be a coroutine, "&lt;/span&gt;
                    &lt;span class="s"&gt;"not {!r}"&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;/pre&gt;


&lt;p&gt;&lt;strong&gt;Update:&lt;/strong&gt; &lt;em&gt;This post originally suggested a combined "run_in_background"
helper function that handle both scheduling coroutines and calling arbitrary
callables in a background thread or process. On further reflection, I decided
that was unhelpfully conflating two different concepts, so I replaced it with
separate "schedule_coroutine" and "call_in_background" helpers&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;So now I can do:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;itertools&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;async&lt;/span&gt; &lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;ticker&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="n"&gt;itertools&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;count&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;        &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="gp"&gt;... &lt;/span&gt;        &lt;span class="n"&gt;await&lt;/span&gt; &lt;span class="n"&gt;asyncio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="gp"&gt;...&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;ticker1&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;schedule_coroutine&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ticker&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;ticker1&lt;/span&gt;
&lt;span class="go"&gt;&amp;lt;Task pending coro=&amp;lt;ticker() running at &amp;lt;stdin&amp;gt;:1&amp;gt;&amp;gt;&lt;/span&gt;
&lt;/pre&gt;


&lt;p&gt;But how do I run that for a while? The event loop won't run unless the current
thread starts it running and either stops when a particular event occurs, or
when explicitly stopped. Another helper function covers that:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;run_in_foreground&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;task&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;loop&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;"""Runs event loop in current thread until the given task completes&lt;/span&gt;

&lt;span class="sd"&gt;    Returns the result of the task.&lt;/span&gt;
&lt;span class="sd"&gt;    For more complex conditions, combine with asyncio.wait()&lt;/span&gt;
&lt;span class="sd"&gt;    To include a timeout, combine with asyncio.wait_for()&lt;/span&gt;
&lt;span class="sd"&gt;    """&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;loop&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;loop&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;asyncio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_event_loop&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;loop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;run_until_complete&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;asyncio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;ensure_future&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;task&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;loop&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="n"&gt;loop&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;


&lt;p&gt;And then I can do:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;run_in_foreground&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;asyncio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="go"&gt;0&lt;/span&gt;
&lt;span class="go"&gt;1&lt;/span&gt;
&lt;span class="go"&gt;2&lt;/span&gt;
&lt;span class="go"&gt;3&lt;/span&gt;
&lt;span class="go"&gt;4&lt;/span&gt;
&lt;/pre&gt;


&lt;p&gt;Here we can see the background task running while we wait for the foreground
task to complete. And if I do it again with a different timeout:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;run_in_foreground&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;asyncio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;3&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="go"&gt;5&lt;/span&gt;
&lt;span class="go"&gt;6&lt;/span&gt;
&lt;span class="go"&gt;7&lt;/span&gt;
&lt;/pre&gt;


&lt;p&gt;We see that the background task picked up again right where it left off
the first time.&lt;/p&gt;
&lt;p&gt;We can also single step the event loop with a zero second sleep (the ticks
reflect the fact there was more than a second delay between running each
command):&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;run_in_foreground&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;asyncio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="go"&gt;8&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;run_in_foreground&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;asyncio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="go"&gt;9&lt;/span&gt;
&lt;/pre&gt;


&lt;p&gt;And start a second ticker to run concurrently with the first one:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;ticker2&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;schedule_coroutine&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;ticker&lt;/span&gt;&lt;span class="p"&gt;())&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;ticker2&lt;/span&gt;
&lt;span class="go"&gt;&amp;lt;Task pending coro=&amp;lt;ticker() running at &amp;lt;stdin&amp;gt;:1&amp;gt;&amp;gt;&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;run_in_foreground&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;asyncio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="go"&gt;0&lt;/span&gt;
&lt;span class="go"&gt;10&lt;/span&gt;
&lt;/pre&gt;


&lt;p&gt;The asynchronous tickers will happily hang around in the background, ready to
resume operation whenever I give them the opportunity. If I decide I want to
stop one of them, I can cancel the corresponding task:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;ticker1&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cancel&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="go"&gt;True&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;run_in_foreground&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;asyncio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;span class="go"&gt;1&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;ticker2&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;cancel&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
&lt;span class="go"&gt;True&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;run_in_foreground&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;asyncio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;0&lt;/span&gt;&lt;span class="p"&gt;))&lt;/span&gt;
&lt;/pre&gt;


&lt;p&gt;But what about our original &lt;em&gt;synchronous&lt;/em&gt; ticker? Can I run that as a
background task? It turns out I can, with the aid of another helper function:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;call_in_background&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="o"&gt;*&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;loop&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;executor&lt;/span&gt;&lt;span class="o"&gt;=&lt;/span&gt;&lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
    &lt;span class="sd"&gt;"""Schedules and starts target callable as a background task&lt;/span&gt;

&lt;span class="sd"&gt;    If not given, *loop* defaults to the current thread's event loop&lt;/span&gt;
&lt;span class="sd"&gt;    If not given, *executor* defaults to the loop's default executor&lt;/span&gt;

&lt;span class="sd"&gt;    Returns the scheduled task.&lt;/span&gt;
&lt;span class="sd"&gt;    """&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="n"&gt;loop&lt;/span&gt; &lt;span class="ow"&gt;is&lt;/span&gt; &lt;span class="bp"&gt;None&lt;/span&gt;&lt;span class="p"&gt;:&lt;/span&gt;
        &lt;span class="n"&gt;loop&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;asyncio&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;get_event_loop&lt;/span&gt;&lt;span class="p"&gt;()&lt;/span&gt;
    &lt;span class="k"&gt;if&lt;/span&gt; &lt;span class="nb"&gt;callable&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;return&lt;/span&gt; &lt;span class="n"&gt;loop&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;run_in_executor&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;executor&lt;/span&gt;&lt;span class="p"&gt;,&lt;/span&gt; &lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;raise&lt;/span&gt; &lt;span class="ne"&gt;TypeError&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"target must be a callable, "&lt;/span&gt;
                    &lt;span class="s"&gt;"not {!r}"&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;format&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="nb"&gt;type&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;target&lt;/span&gt;&lt;span class="p"&gt;)))&lt;/span&gt;
&lt;/pre&gt;


&lt;p&gt;However, I haven't figured out how to reliably cancel a task running in a
separate thread or process, so for demonstration purposes, we'll define a
variant of the synchronous version that stops automatically after 5 ticks
rather than ticking indefinitely:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="kn"&gt;import&lt;/span&gt; &lt;span class="nn"&gt;itertools&lt;/span&gt;&lt;span class="o"&gt;,&lt;/span&gt; &lt;span class="nn"&gt;time&lt;/span&gt;
&lt;span class="k"&gt;def&lt;/span&gt; &lt;span class="nf"&gt;tick_5_sync&lt;/span&gt;&lt;span class="p"&gt;():&lt;/span&gt;
    &lt;span class="k"&gt;for&lt;/span&gt; &lt;span class="n"&gt;i&lt;/span&gt; &lt;span class="ow"&gt;in&lt;/span&gt; &lt;span class="nb"&gt;range&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;5&lt;/span&gt;&lt;span class="p"&gt;):&lt;/span&gt;
        &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;i&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
        &lt;span class="n"&gt;time&lt;/span&gt;&lt;span class="o"&gt;.&lt;/span&gt;&lt;span class="n"&gt;sleep&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
    &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Finishing"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;/pre&gt;


&lt;p&gt;The key difference between scheduling a callable in a background thread and
scheduling a coroutine in the current thread, is that the callable will start
executing immediately, rather than waiting for the current thread
to run the event loop:&lt;/p&gt;
&lt;pre class="code literal-block"&gt;&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="n"&gt;threaded_ticker&lt;/span&gt; &lt;span class="o"&gt;=&lt;/span&gt; &lt;span class="n"&gt;call_in_background&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="n"&gt;tick_5_sync&lt;/span&gt;&lt;span class="p"&gt;);&lt;/span&gt; &lt;span class="k"&gt;print&lt;/span&gt;&lt;span class="p"&gt;(&lt;/span&gt;&lt;span class="s"&gt;"Starts immediately!"&lt;/span&gt;&lt;span class="p"&gt;)&lt;/span&gt;
&lt;span class="go"&gt;0&lt;/span&gt;
&lt;span class="go"&gt;Starts immediately!&lt;/span&gt;
&lt;span class="gp"&gt;&amp;gt;&amp;gt;&amp;gt; &lt;/span&gt;&lt;span class="mi"&gt;1&lt;/span&gt;
&lt;span class="go"&gt;2&lt;/span&gt;
&lt;span class="go"&gt;3&lt;/span&gt;
&lt;span class="go"&gt;4&lt;/span&gt;
&lt;span class="go"&gt;Finishing&lt;/span&gt;
&lt;/pre&gt;


&lt;p&gt;That's both a strength (as you can run multiple blocking IO operations in
parallel), but also a significant weakness - one of the benefits of explicit
coroutines is their predictability, as you know &lt;em&gt;none&lt;/em&gt; of them will start
doing anything until you start running the event loop.&lt;/p&gt;&lt;/div&gt;</description><category>python</category><guid>http://www.curiousefficiency.org/posts/2015/07/asyncio-background-calls.html</guid><pubDate>Fri, 10 Jul 2015 08:17:53 GMT</pubDate></item><item><title>Stop Supporting Python 2.6 (For Free)</title><link>http://www.curiousefficiency.org/posts/2015/04/stop-supporting-python26.html</link><dc:creator>Nick Coghlan</dc:creator><description>&lt;div&gt;&lt;p&gt;(Note: I'm speaking with my "CPython core developer" hat on in this article,
rather than my "Red Hat employee" one, although it's the latter role that
gave me broad visibility into the Fedora/RHEL/CentOS Python ecosystem)&lt;/p&gt;
&lt;p&gt;Alex Gaynor recently raised some
&lt;a href="https://alexgaynor.net/2015/mar/30/red-hat-open-source-community/"&gt;significant concerns&lt;/a&gt;
in relation to his perception that Red Hat expects the upstream community
to support our long term support releases for as long as we do, only without
getting paid for it.&lt;/p&gt;
&lt;p&gt;That's not true, so I'm going to say it explicitly: if you're currently
supporting Python 2.6 for free because folks using RHEL 6 or one of its
derivatives say they need it, and this is proving to be a hassle for you,
then stop. If they complain, then point them at this post, as providing an
easily linkable reference for that purpose is one of the main reasons I'm
writing it. If they still don't like it, then you may want to further suggest
that they come argue with me about it, and leave you alone.&lt;/p&gt;
&lt;p&gt;The affected users have more options than they may realise, and upstream
open source developers shouldn't feel obliged to donate their own time to
help end users cope with organisations that aren't yet able to upgrade their
internal infrastructure in a more timely fashion.&lt;/p&gt;
&lt;h2&gt;Red Hat Supported Python Upgrade Paths&lt;/h2&gt;
&lt;p&gt;Since &lt;a href="https://developerblog.redhat.com/2013/09/12/rhscl1-ga/"&gt;September 2013&lt;/a&gt;,
Red Hat Enterprise Linux subscriptions have included access to an additional
component called
&lt;a href="https://access.redhat.com/documentation/en-US/Red_Hat_Software_Collections/1/html/1.2_Release_Notes/chap-RHSCL.html#sect-RHSCL-About"&gt;Red Hat Software Collections&lt;/a&gt;. You can think of Software Collections roughly
as "virtualenv for the system package manager", providing access to newer
language runtimes (including Python 2.7 and 3.3), database runtimes, and
web server runtimes, all without interfering with the versions of those
integrated with (and used by) the operating system layer itself.&lt;/p&gt;
&lt;p&gt;This model (and the fact they're included with the base Red Hat Enterprise
Linux subscription) means that Red Hat subscribers are able to install
and use these newer runtimes without needing to upgrade the entire operating
system.&lt;/p&gt;
&lt;p&gt;Since &lt;a href="https://developerblog.redhat.com/2014/06/10/red-hat-enterprise-linux-7-now-generally-available/"&gt;June 2014&lt;/a&gt;,
Red Hat Enterprise Linux 7 has also been available, including an upgrade of
the system Python to Python 2.7. The latest release of that is
&lt;a href="https://www.redhat.com/en/about/press-releases/red-hat-continues-platform-innovation-general-availability-first-minor-release-red-hat-enterprise-linux-7"&gt;Red Hat Enterprise Linux 7.1&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;As Red Hat subscriptions all include free upgrades to new releases, the main
barrier to deployment of these newer Python releases is
&lt;a href="https://twitter.com/kevinrkosar/status/583786245261754368"&gt;institutional inertia&lt;/a&gt;.
While it's entirely admirable that many upstream developers are generous
enough to help their end users work around this inertia, in the long run
doing so is detrimental for everyone concerned, as long term sustaining
engineering for old releases is genuinely demotivating for upstream
developers (it's a good job, but a lousy way to spend your free time), and
for end users, working around institutional inertia this way reduces the
pressure to actually get the situation addressed properly.&lt;/p&gt;
&lt;p&gt;Beyond Red Hat Enterprise Linux, Red Hat's portfolio also includes
both the &lt;a href="https://www.openshift.com/"&gt;OpenShift&lt;/a&gt; Platform-as-a-Service
offering and the &lt;a href="http://www.feedhenry.com/"&gt;Feed Henry&lt;/a&gt; Mobile Application
Platform. For many organisations looking to adopt an iterative approach to
web service development, those are going to be a better fit than deploying
directly to Red Hat Enterprise Linux and building a custom web service
management system around that.&lt;/p&gt;
&lt;h2&gt;Third Party Supported Python Upgrade Paths&lt;/h2&gt;
&lt;p&gt;The current Red Hat supported upgrade paths require administrative access to
a system. While it's aimed primarily at scientific users, the comprehensive
&lt;a href="https://store.continuum.io/cshop/anaconda/"&gt;Anaconda Python distribution&lt;/a&gt;
from Continuum Analytics is a good way to obtain prebuilt versions of Python
for Red Hat Enterprise Linux that can be installed by individual users
without administrative access.&lt;/p&gt;
&lt;p&gt;At Strata 2015, Continuum's Python distribution not only featured in a
combined announcement regarding on-premise deployment of &lt;a href="http://redhatstorage.redhat.com/2015/02/17/deploying-pyspark-on-red-hat-storage-glusterfs/"&gt;Anaconda Cluster
together with Red Hat Storage&lt;/a&gt;,
but also in Microsoft's announcement of Python support in the
&lt;a href="http://continuum.io/blog/azureml"&gt;Azure Machine Learning service&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;For users that don't need a full scientific Python distribution, Continuum
Analytics also offer &lt;a href="http://continuum.io/downloads"&gt;miniconda&lt;/a&gt; which just
provides a Python runtime and the conda package manager, providing end users
with a cross-platform way to obtain and manage multiple Python runtimes
without needing administrative access to their systems.&lt;/p&gt;
&lt;h2&gt;Community Supported Python Upgrade Paths&lt;/h2&gt;
&lt;p&gt;The question of providing upgrade paths for folks without an active Red Hat
subscription has also been taken into consideration.&lt;/p&gt;
&lt;p&gt;In &lt;a href="https://www.redhat.com/en/about/press-releases/red-hat-and-centos-join-forces"&gt;January 2014&lt;/a&gt;
Red Hat became an official sponsor of the long established CentOS project,
with the aim of providing a stable base for community open source innovation
above the operating system layer (this aim contrasts with the aims of the
Fedora project, which is intended primarily to drive innovation within the
operating system layer itself).&lt;/p&gt;
&lt;p&gt;CentOS 7 was originally released in
&lt;a href="http://seven.centos.org/2014/07/release-announcement-for-centos-7x86_64/"&gt;July 2014&lt;/a&gt;,
and the latest release, CentOS 7(1503), was just published (as the name
suggests) in
&lt;a href="http://seven.centos.org/2015/03/centos-7-1503-is-released/"&gt;March 2015&lt;/a&gt;).&lt;/p&gt;
&lt;p&gt;For CentOS and other RHEL derivatives, the upstream project for Red Hat
Software Collections is hosted at
&lt;a href="https://www.softwarecollections.org/en/"&gt;softwarecollections.org&lt;/a&gt;, making
these collections available to the whole Fedora/RHEL/CentOS ecosystem, rather
than only being available to Red Hat subscribers.&lt;/p&gt;
&lt;p&gt;Folks running Fedora Rawhide that are particularly keen to be on the cutting
edge of Python can even obtain prerelease Python 3.5 nightly builds as a
software collection from Miro Hronok's
&lt;a href="https://copr.fedoraproject.org/coprs/churchyard/python3-nightly/"&gt;Fedora COPR repository&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;In addition to maintaining Fedora itself, the Fedora community also maintains
the &lt;a href="https://fedoraproject.org/wiki/EPEL"&gt;Extra Packages for Enterprise Linux&lt;/a&gt;
(EPEL) repositories, providing ready access to non-conflicting packages
beyond those in the set included in the base Red Hat Enterprise Linx and
CentOS releases.&lt;/p&gt;
&lt;h2&gt;Providing Commercial Red Hat Enterprise Linux Support&lt;/h2&gt;
&lt;p&gt;If projects are regularly receiving requests for support on Red Hat Enterprise
Linux and derived platforms, and the developers involved are actively looking
to build a sustainable business around their software, then a steady stream
of these requests may represent an opportunity worth exploring. After all,
Red Hat's subscribers all appreciate the value that deploying commercially
supported open source software can bring to an organisation, and are
necessarily familiar with the use of software subscriptions to support
sustaining engineering and the ongoing development of new features for the
open source software that they deploy.&lt;/p&gt;
&lt;p&gt;One of the key things that many customers are looking for is pre-release
integration testing to provide some level of assurance that the software
they deploy will work in their environment, while another is a secure
development and distribution pipeline that ensures that the software they
install is coming from organisations that they trust.&lt;/p&gt;
&lt;p&gt;One of Red Hat's essential tools for managing this distributed integration
testing and content assurance effort is its
&lt;a href="https://www.redhat.com/en/partners"&gt;Partner Program&lt;/a&gt;. This program is
designed to not only assist Red Hat subscribers in finding supported
software that meets their needs, but also to provide Red Hat, partners, and
customers with confidence that the components of deployed solutions will
work well together in target deployment environments.&lt;/p&gt;
&lt;p&gt;Specifically for web service developers that would like to provide a
supported on-premise offering, last year's announcement of a &lt;a href="https://www.redhat.com/en/about/press-releases/red-hat-announces-certification-for-containerized-applications-extends-customer-confidence-and-trust-to-the-cloud"&gt;Container Certification Program&lt;/a&gt;
(with Red Hat Enterprise Linux 7 and the OpenShift Platform-as-a-Service
offering as certified container hosts) extended Red Hat's certification
programs to cover the certification of Docker containers in addition to
other forms of Linux application deployment.&lt;/p&gt;
&lt;p&gt;Even more recently, the
&lt;a href="http://connect.redhat.com/zones/containers"&gt;Red Hat Container Development Kit&lt;/a&gt;
was introduced to help streamline that certification process for Red Hat
Independent Software Vendor Partners.&lt;/p&gt;
&lt;p&gt;But these are all things that folks should only explore if they're
specifically interested in building a commercial support business around
their software. If users are trying to get long term maintenance support
for a community project for free, then upstream developers should be sending
a single unified message in response: don't assume you'll be able to run
new versions of open source software on old platforms unless you're
specifically paying someone to ensure that happens.&lt;/p&gt;
&lt;p&gt;I'm not saying this because I work for a platform vendor that gets paid (at
least in part) to do this, I'm saying it because most open source projects
are maintained by innovators that are upgrading their technology stacks
regularly, where versions of components are already old after 2 years and
truly ancient after 5. Expecting open source innovators to provide long term
maintenance for free is simply unreasonable - regularly upgrading their own
stacks means they don't need this long term platform support for themselves,
so the folks that are seeking it should be expected to pay for it to happen.
(Apparent exceptions like CentOS aren't exceptions at all: sustaining
engineering on CentOS is instead a beneficial community byproduct of the
&lt;a href="http://crunchtools.com/deep-dive-rebase-vs-backport/"&gt;paid sustaining engineering&lt;/a&gt;
that goes into Red Hat Enterprise Linux).&lt;/p&gt;&lt;/div&gt;</description><category>python</category><guid>http://www.curiousefficiency.org/posts/2015/04/stop-supporting-python26.html</guid><pubDate>Sat, 04 Apr 2015 09:30:05 GMT</pubDate></item><item><title>Abusing Contributors is not OK</title><link>http://www.curiousefficiency.org/posts/2015/01/abuse-is-not-ok.html</link><dc:creator>Nick Coghlan</dc:creator><description>&lt;div&gt;&lt;p&gt;As reported in
&lt;a href="http://arstechnica.com/business/2015/01/linus-torvalds-on-why-he-isnt-nice-i-dont-care-about-you/"&gt;Ars Technica&lt;/a&gt;,
the ongoing efforts to promote diversity in open source communities came
up once more during the plenary Q&amp;amp;A session with Linus Torvalds, Andrew Tridgell,
Bdale Garbee and Rusty Russell.&lt;/p&gt;
&lt;p&gt;I was there for that session, and found that Linus's response appeared to
betray a fundamental misunderstanding of the motives of many of the folks
pushing for increased diversity in the open source community, as well as a
lack of awareness of the terrible situations that can arise when leaders in a
community regularly demonstrate abusive behaviour without suffering any
significant consequences (just ask folks like Kathy Sierra, Zoe Quinn, Anita
Sarkeesian and Brianna Wu that have been subjected to sustained campaigns of
harassment largely for being women that dared to have and express an opinion
on the internet).&lt;/p&gt;
&lt;p&gt;As the coordinator of the Python Software Foundation's contribution to the
linux.conf.au 2015 financial assistance program, and as someone with a deep
personal interest in the overall success of the open source community, I feel
it is important for me to state explicitly that I consider Linus's level of
ignorance around appropriate standards of community conduct to be unacceptable
in an open source community leader in 2015.&lt;/p&gt;
&lt;p&gt;Linus's defence of his abusive behaviour is that he's "not nice", and
"doesn't care about you". He does care deeply about his project, though,
and claims to be motivated primarily by wanting that to continue to be
successful.&lt;/p&gt;
&lt;p&gt;To be completely honest, the momentum behind the Linux juggernaut is now
large enough that Linus could likely decide to chuck it all in and spend the
rest of his life on a beach sipping cocktails without worrying about open
source politics, and people would figure out a way to ensure that Linux
continued to thrive and grow without him. Many a successful start-up has made
that transition when the founders leave, and there's no good reason to believe
an open source community would be fundamentally different in that regard. The
transition to a new leadership structure might be a little messy, but the
community would almost certainly figure it out.&lt;/p&gt;
&lt;p&gt;However, there's still a lot of scope for Linus to influence &lt;em&gt;how fast&lt;/em&gt; Linux
grows, and on that front his words and actions suggest that he considers
being careless in his speech, without regard for the collateral damage
his verbal broadsides may be doing to his cause, more important than
having the most positive impact he is capable of having on the future growth
of the Linux kernel development project and the open source community at
large.&lt;/p&gt;
&lt;h2&gt;It's not (necessarily) about being nice&lt;/h2&gt;
&lt;p&gt;It may surprise some folks to learn that I don't consider myself a nice human
either. My temper is formidable (I just keep it under control most of the
time, a task online communication makes easier by providing the ability to
walk away from the computer for a while), and any feelings of compassion I
have for others are more a product of years of deliberate practice and
hanging around with compassionate people than they are any particularly
strong innate knack for empathy.&lt;/p&gt;
&lt;p&gt;I'm pretty sure that genuinely nice people do exist, and I assume
that one of their key motives for creating open, welcoming, inclusive
communities is because it's fundamentally the right thing to do. The main
reason I exclude myself from my assumed category of "nice people" is that,
while I acknowledge that motivation intellectually, it's not really one that
I feel viscerally.&lt;/p&gt;
&lt;p&gt;Instead, what I do care about, passionately, is &lt;em&gt;helping the best ideas win&lt;/em&gt;
(where I include "feasible" as part of my definition of "best"). Not the
"best ideas from people willing to tolerate extensive personal abuse".
The best ideas anyone is willing to share with me, period. And I won't hear
those ideas unless I help create environments where all participants are
willing to speak up, not just those that are prepared to accept a blistering
verbal barrage from a powerful authority figure as a possible consequence of
attempting to participate. Those are upsetting enough when they come from
random strangers on the internet, when they come from someone with enormous
influence not only over you and your future career, but also your entire
industry, they can be devastating.&lt;/p&gt;
&lt;h2&gt;The second order consequences&lt;/h2&gt;
&lt;p&gt;So there you have it, my not-nice reason for advocating for more welcoming and
inclusive open source communities: because, from an engineering standpoint, I
consider "has a high level of tolerance for receiving personal abuse from
community leaders" to be an extraordinarily stupid filter to apply to your
pool of potential contributors.&lt;/p&gt;
&lt;p&gt;Exhibiting abusive behaviour as a leader has additional consequences though,
and they can be even more problematic: by regularly demonstrating abusive
behaviour yourself, you end up normalising harassment within your community
in general, both in public and in private.&lt;/p&gt;
&lt;p&gt;I believe Linus when he says he doesn't care about who people are or where
they're from, only their contributions. I'm the same way - until I've known
them for a while, I tend to care about contributors and potential
contributors wholesale (i.e. happy people that enjoy the environment
they're participating in tend to spend more time engaged, learn faster,
produce superior contributions, and more quickly reach the point of being
able to contribute independently), rather than retail (i.e. I care about my
friends because they're my friends, regardless of context).&lt;/p&gt;
&lt;p&gt;But when you're personally abusive as a leader, you also have to take a high
level of responsibility for all the folks that look up to you as a role
model, and act out the same behaviours you exhibit in public. When you reach
this point, the preconditions for participation in your community now include:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Willing to tolerate public personal abuse from project leaders&lt;/li&gt;
&lt;li&gt;Willing to tolerate public personal abuse from the community at large&lt;/li&gt;
&lt;li&gt;Willing to tolerate personal abuse in private&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;With clauses like that as part of the definition, the claim of "meritocracy"
starts to feel a little shaky, doesn't it? Meritocracy is a fine ideal
to strive for, but claiming to have achieved it when you're imposing
irrelevant requirements like this is arrogant nonsense.&lt;/p&gt;
&lt;p&gt;We're not done yet, though, as this culture of abuse then combines with
elitism based on previously acquired knowledge to make it normal to &lt;em&gt;abuse
newcomers for still being in the process of learning&lt;/em&gt;. I find it hard to
conceive of a more effective approach to keeping people from adopting
something you're giving away for free than tolerating a community that
publicly abuses people for not magically already knowing how to use
technology that they may have never even heard of before.&lt;/p&gt;
&lt;p&gt;As a result of this perspective, the only time I'll endeavour to eject anyone
from a community where I have significant influence is when they're actively
creating an unpleasant environment for other participants, and demonstrate no
remorse whatsoever regarding the negative impact their actions are having on
the overall collaborative effort. I count myself incredibly fortunate to
have only had to do this a few times in my life so far, but it's something
I believe in strongly enough for it to have been the basis for once deciding
to resign from a position paying a six-figure salary at a company I otherwise
loved working for. To that company's credit, the abusive leader was let go
not long afterwards, but the whole secretive corporate system is rigged such
that these toxic "leaders" can usually quickly find new positions elsewhere
and hence new subordinates to make miserable - the fact that I'm not willing
to name names here for fear of the professional consequences is just one more
example of how the system is largely set up to protect abusive leaders rather
than holding them to account for the impact their actions have on others.&lt;/p&gt;
&lt;h2&gt;Ideas and code are still fair game&lt;/h2&gt;
&lt;p&gt;One of the spurious fears raised against the apparently radical notion of
refusing to tolerate personal abuse in a collaborative environment is that
adopting civil communication practices somehow means that bad &lt;em&gt;code&lt;/em&gt; must
then be accepted into the project.&lt;/p&gt;
&lt;p&gt;Eliminating personal abuse doesn't mean eliminating rigorous critique of
code and ideas. It just means making sure that you &lt;em&gt;are&lt;/em&gt; critiquing the
code and the ideas, rather than tearing down the person contributing them.
It's the difference between "This code isn't any good, here are the problems
with it, I'm confident you can do better on your next attempt" (last part
optional but usually beneficial when it comes to growing your contributor
community) and "This code is terrible, how dare you befoul my presence with
it, begone from my sight, worm!".&lt;/p&gt;
&lt;p&gt;The latter response may be a funny joke if done in private between close
friends, but when it's done in public, in front of a large number of
onlookers who don't know either the sender or the recipient personally, it
sets an astoundingly bad example as to what a mutually beneficial
collaborative peer relationship should look like.&lt;/p&gt;
&lt;p&gt;And if you don't have the self-discipline needed to cope with the changing
context of our online interactions in the open source community? Well,
perhaps you don't yet have the temperament needed to be an open source leader
on an internet that is no longer the sole preserve of those of us that are
more interested in computers than we are in people. Most of the technical and
business press have yet to figure out that they can actually do a bit of
investigative journalism to see how well vendor rhetoric aligns with upstream
open source engineering activity (frequency of publication is still a far
more important performance metric for most journalists than questioning the
spin served up in corporate press releases), so the number of folks peering
into the open source development fishbowl is only going to grow over time.&lt;/p&gt;
&lt;p&gt;It isn't &lt;em&gt;that&lt;/em&gt; hard to learn the necessary self-control, though. It's mostly
just a matter of taking the time to read each email or code review comment,
look for the parts that are about the contributor rather than the code or the
design, and &lt;em&gt;remove them before hitting send&lt;/em&gt;. And if that means there's
nothing left? Then what you were about to send was pure noise, adding nothing
useful to the conversation, and hence best left unsent. Doing anything less
than this as a community leader is pure self-indulgence, putting your own
unwillingness to consider the consequences of your communications ahead of
the long term interests of your project. We're only talking about software
here, after all - lives aren't on the line when we're deciding how to respond
to a particular contribution, so we can afford to take a few moments to
review the messages we're about to send and consider how they're likely to
be perceived, both by the recipient, and by everyone else observing the
exchange.&lt;/p&gt;
&lt;p&gt;With any personal abuse removed, you can be as ruthless about critiquing the
code and design as you like. Learning not to take critiques of your work
personally &lt;em&gt;is&lt;/em&gt; a necessary skill to acquire if your ambition is to become a
high profile open source developer - the compromises often necessary in the
real world of software design and development mean that you &lt;em&gt;will&lt;/em&gt; end up
shipping things that can legitimately be described as terrible, and you're
going to have to learn to be able to say "Yes, I know it's terrible, for
reasons X, Y, and Z, and I decided to publish it anyway. If you don't like
it, don't use it.". (I highly recommend giving talks about these areas you
know are terrible - they're fun to prepare, fun to give, and it's quite
entertaining seeing the horrified reactions when people realise I'm not
kidding when I say all software is terrible and computers don't actually
work, they just fake it fairly well through an ongoing series of horrible
hacks built atop other horrible hacks. I'm not surprised the Internet
breaks sometimes - given the decades of accumulated legacy hardware and
software we're building on and working around, it's thoroughly astonishing
that anything technology related ever works at all)&lt;/p&gt;
&lt;p&gt;But no matter how harsh your technical critiques get, never forget that
there's at least one other human on the far end of that code review or
email thread. Even if you don't personally care about &lt;em&gt;them&lt;/em&gt;, do you really
think it's a good idea to go through life providing large numbers of people
with public evidence of why &lt;em&gt;you&lt;/em&gt; are a thoroughly unpleasant person to be
forced to deal with? As a project leader, do you really think you're going
to attract the best and brightest people, who are often free to spend their
time and energy however they like, if you set up a sign saying "You must be
willing to tolerate extensive personal abuse in order to participate here"?&lt;/p&gt;
&lt;h2&gt;What can we do about it?&lt;/h2&gt;
&lt;p&gt;First, and foremost, for those of us that &lt;em&gt;are&lt;/em&gt; paid open source community
leaders, we can recognise that understanding and motivating our contributors
and potential contributors in order to grow our communities is &lt;em&gt;part of our
job&lt;/em&gt;. If we don't like that, if we'd prefer to be able to "just focus on the
code", to the degree where we're not willing to learn how to moderate our
own behaviour in accordance with our level of responsibility, then we need
to figure out how to reorganise things such that there's someone with better
people management and communication skills in a position to act as a buffer
between us and our respective communities.&lt;/p&gt;
&lt;p&gt;If we instead decide we need to better educate ourselves, then there are
plenty of resources available for us to do so. For folks just beginning to
explore questions of systemic bias and defaulting to exclusivity,
gender-based bias is a good one to start with, by perusing resources like the
&lt;a href="http://geekfeminism.wikia.com/wiki/Feminism_101"&gt;Feminism 101&lt;/a&gt; section on
the Geek Feminism wiki, or (if we have the opportunity) attending an
Ada Initiative
&lt;a href="http://adainitiative.org/what-we-do/workshops-and-training/"&gt;Ally Skills workshop&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;And if we &lt;em&gt;do&lt;/em&gt; acknowledge the importance of this work, then we can use our
influence to help it continue, whether that's by sponsoring educational
workshops, supporting financial assistance programs, ensuring suitable codes
of conduct are in place for our events and online communities, supporting
programs like the GNOME Outreach Program for Women, or organisations like
the Ada Initiative, and so on, and so forth.&lt;/p&gt;
&lt;p&gt;For those of us that &lt;em&gt;aren't&lt;/em&gt; community leaders, then one of the most
effective things we can do is vote with our feet: at last count, there are
over a million open source projects in existence, many of them are run in
such a way that participating in them is almost always a sheer pleasure,
and if no existing community grabs your interest, you always have the option
of starting your own.&lt;/p&gt;
&lt;p&gt;Personal enjoyment is only one reason for participating in open source though,
and professional obligations or personal needs may bring us into contact with
project leaders and contributors that currently consider personal abuse to be
an acceptable way of interacting with their peers in a collaborative context.
If leaving isn't a viable option, then what can we do?&lt;/p&gt;
&lt;p&gt;Firstly, the options I suggest above for community leaders are actually good
options for &lt;em&gt;any&lt;/em&gt; participants in the open source community that view the
overall growth and success of the free and open source software ethos as
being more important than any one individual's personal pride or reluctance to
educate themselves about issues that don't affect them personally.&lt;/p&gt;
&lt;p&gt;Secondly, we can hold our leaders to account. When community leaders give
presentations at community events, especially when presenting on community
management topics, feel free to ask the following questions (or variations
on these themes):&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Are we as community leaders aware of the impact current and historical
  structural inequalities have on the demographics of our community?&lt;/li&gt;
&lt;li&gt;What have we done recently as individuals to improve our understanding of
  these issues and their consequences?&lt;/li&gt;
&lt;li&gt;What have we done recently as community leaders to attempt to counter the
  systemic biases adversely affecting the demographics of our communities?&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;These are questions that open source community leaders &lt;em&gt;should&lt;/em&gt; be able to
answer. When we can't, I guess the silver lining is that it means we have
plenty of scope to get better at what we do. For members of vulnerable
groups, an inability for leaders to answer these questions is also a
strong sign as to which communities may not yet be able to provide safe
spaces for you to participate without experiencing harassment over your
identity rather than being critiqued solely based on the quality of your
work.&lt;/p&gt;
&lt;p&gt;If you ask these questions, you &lt;em&gt;will&lt;/em&gt; get people complaining about bringing
politics into a technical environment. The folks complaining are simply wrong,
as the single most important factor driving the quality of our technology is
the quality of our thinking. Assuming we have attained meritocracy (aka "the
most effective collaborative environment possible") is sheer foolishness,
when a wide array of systemic biases remain in place that work to reduce the
depth, breadth, and hence quality, of our collective thinking.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Update 22 Jan, 2015: Minor typo and grammar fixes&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Update 19 Apr, 2016: This article is also available in
&lt;a href="http://www.everycloudtech.com/abuse-is-not-ok"&gt;Russian&lt;/a&gt;,
thanks to &lt;a href="http://www.everycloudtech.com/"&gt;Everycloud technologies&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;&lt;em&gt;Update 1 Dec, 2016: This article is also available in
&lt;a href="http://www.autoteileprofi.de/science/2016/12/01/kuritarvitamises-toetajad-ei-ole-ok/"&gt;Estonian&lt;/a&gt;,
thanks to Arija Liepkalnietis&lt;/em&gt;&lt;/p&gt;&lt;/div&gt;</description><category>python</category><category>tech</category><guid>http://www.curiousefficiency.org/posts/2015/01/abuse-is-not-ok.html</guid><pubDate>Thu, 22 Jan 2015 05:57:26 GMT</pubDate></item><item><title>DTCA Public Consultation - Brisbane</title><link>http://www.curiousefficiency.org/posts/2015/01/dtca-public-consultation.html</link><dc:creator>Nick Coghlan</dc:creator><description>&lt;div&gt;&lt;p&gt;Over the weekend, Asher Wolf
&lt;a href="https://twitter.com/Asher_Wolf/status/555909774596784129"&gt;alerted me&lt;/a&gt; (and
many others in the open source and cryptographic communities) to the
Australian Defence Trade Controls Act 2012, and the current public
consultation taking place around a bill proposing amendments to that act.&lt;/p&gt;
&lt;p&gt;Being heavily involved in improving the security of open source
infrastructure like the &lt;a href="https://pypi.python.org/"&gt;Python Package Index&lt;/a&gt;
and the
&lt;a href="https://www.python.org/dev/peps/pep-0466/"&gt;Python 2 reference interpreter&lt;/a&gt;,
working at a multinational open source vendor, and having an extensive
background in working under the constraints of the US International Traffic
in Arms regulations, Asher's concern caught my attention, since bad
legislation in this area can have significant chilling effects on legitimate
research and development activities.&lt;/p&gt;
&lt;p&gt;As a result, I've escalated this legislation for review by the legal teams
at various open source companies and organisations, with a view to making
formal submissions to the
&lt;a href="http://www.defence.gov.au/deco/Consultation.asp"&gt;public consultation process&lt;/a&gt;
that is open until January 30th (ready for bills to be submitted for
consideration to federal parliament on February 23rd).&lt;/p&gt;
&lt;p&gt;However, I was also able to attend the first public consultation session
held at the University of Queensland on January 19, so these are my
impressions based primarily on that sessions and my own experiences dealing
with ITAR. I'm not a lawyer and I haven't actually &lt;em&gt;read&lt;/em&gt; the legislation,
so I'm not going to pick up on any drafting errors, but I can at least speak
to the intent of the folks involved in moving this process forward.&lt;/p&gt;
&lt;h2&gt;What &lt;em&gt;not&lt;/em&gt; to worry about&lt;/h2&gt;
&lt;p&gt;To folks encountering this kind of legislation for the first time, the
sheer scope of the
&lt;a href="http://www.defence.gov.au/deco/DSGL.asp"&gt;Defence and Strategic Goods List&lt;/a&gt;
can seem absolutely terrifying. This was very clear to me from some of the
questions various academics in the room were asking.&lt;/p&gt;
&lt;p&gt;On this particular point, I can only say: &lt;em&gt;"Don't panic"&lt;/em&gt;. This isn't a
unique-to-Australia list, it's backed by a treaty called the
&lt;a href="http://www.wassenaar.org/"&gt;Wassenaar Arrangement&lt;/a&gt; - the DSGL represents
part of the implementation of that arrangement into Australian law.&lt;/p&gt;
&lt;p&gt;When the laws implementing that arrangement are well drafted, everyone outside
the military industrial complex (and certain easily weaponised areas of
scientific research) can pretty much ignore them, while everyone
inside the military industrial complex (and the affected areas of research)
pays very close attention to them because we like not being in jail (and
because gunrunning is bad, and bioterrorism is worse, mmm'kay?).&lt;/p&gt;
&lt;p&gt;A heavily regulated military supply chain is already scary enough, we &lt;em&gt;really&lt;/em&gt;
don't want to see the likely consequences of an unregulated one. (And if
you're tempted to make a snarky comment about the latter already being the
case, no, it really isn't. While folks can sometimes use overclassification
to avoid regulations they're supposed to be following, that still introduces
significant friction and inefficiencies into whatever they're doing. It's not
as good as people actually respecting the laws of the countries they're
supposedly defending, including genuinely meeting the requirement for
civilian authority over the military, but it's still a hell of a lot better
than nothing).&lt;/p&gt;
&lt;p&gt;Getting back on topic, the US ITAR and crypto export control laws are
currently considered the most strict implementation of the Wassenaar
Arrangement amongst the participating nations (going beyond the requirements
of the treaty in several areas), so if you see plenty of US nationals
participating in an activity without being fined and going to jail, you can
be fairly confident that it isn't actually a controlled activity under the
DSGL (or, even if it is, permits for that specific activity will be fairly
easy to get, and the most likely consequence of not realising you need a
permit for something you're doing will be someone from your government
getting in touch to point out that you should apply for one).&lt;/p&gt;
&lt;p&gt;There are certainly some very questionable aspects of this list (with the
perennial "favourite" being the fact the Wassenaar Arrangement does, in fact,
attempt to regulate the global trade in mathematics, which is just as stupid
and problematic as it sounds), but it's a known quantity, and one we're pretty
sure we can continue to live with (at least for the time being).&lt;/p&gt;
&lt;h2&gt;What to worry about&lt;/h2&gt;
&lt;p&gt;The real problem here is that the regulations included in the 2012 Act are
&lt;em&gt;not&lt;/em&gt; well drafted, and the legislated 2 year transition period from May 2013
through to May 2015 prior to the enforcement provisions kicking in is about
to run out.&lt;/p&gt;
&lt;p&gt;The biggest problem with the 2012 act is that in trying to keep things simple
(essentially, "if its on the DSGL, you need a permit"), it ended up becoming
extraordinarily draconian, requiring a permit for things that don't require
an export license even under ITAR.&lt;/p&gt;
&lt;p&gt;For the general public, the most significant shift in the 2015 amendment bill
is the fact that several cases around open publication of information related
to dual-use technologies shift to being allowed by default, and only in
exceptional cases would a permit be required (and in those cases, the onus
would be on the government to inform the covered individuals of that
requirement).&lt;/p&gt;
&lt;p&gt;The amendments also include a variety of additional exemptions for little
things like making it legal for Australian's own police and security agencies
to collaborate with their international counterparts. (Snarky comment
opportunity #2: in certain areas, making such collaboration illegal seems
like a potentially attractive idea...)&lt;/p&gt;
&lt;p&gt;That 2 year pilot was included in the original legislation as a safety
mechanism, the feedback from the associated steering group has been
extensive, and if things had gone according to plan, the relevant amendments
to the bill would have been passed last year in the spring sitting of federal
parliament, leaving DECO with at least 6 months to educate affected
organisations and individuals, and start issuing the now necessary permits
before the enforcement provisions became active in May. Unfortunately, we
currently have a federal government that views pushing a particular
ideological agenda as being more important than &lt;em&gt;actually doing their job&lt;/em&gt;,
so we're now faced with the prospect of regulations that industry doesn't
want, academia doesn't want, the Australian public service don't want, and
the Australian military don't want, coming into effect anyway.&lt;/p&gt;
&lt;p&gt;Isn't politics fun?&lt;/p&gt;
&lt;h2&gt;What DECO are (trying) to do about it&lt;/h2&gt;
&lt;p&gt;The group tasked with untangling this particular legislative Charlie Foxtrot
is the Australian Defence Export Control Office (DECO). Their proposal for
addressing the situation hinges on two bills that they plan to put before
the next sitting of federal parliament:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;an amendment bill for the Act itself, which fixes it to be a conventional
  implementation of the Wassenaar Arrangement, in line with existing
  implementations in other Wassenaar nations (why we didn't just do that in
  the first place is beyond me, but at least DECO are trying to fix the
  mistake now)&lt;/li&gt;
&lt;li&gt;a second bill to delay the enactment of the enforcement provisions for
  a further six months to provide sufficient time for DECO to properly
  educate affected parties and start issuing permits&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;As far as I am aware, the second bill is needed primarily due to the
consideration of the first bill slipping by six months, since we're now
looking at the prospect of only having 4 weeks for DECO to start issuing
permits before the enforcement provisions come into effect. &lt;em&gt;Nobody&lt;/em&gt; involved
thinks that's a good idea.&lt;/p&gt;
&lt;p&gt;If both of those bills pass promptly, then the only cause for concern is
whether or not there are any remaining devils in the details of the
legislation itself. Member of the general public aren't going to be able to
pick those up - despite the surface similarities, legalese isn't English, and
reading it without interpreting it in the context of relevant case law can be
a good way to get yourself into trouble. Summary translations from legalese
to English by a competent lawyer are a much safer bet, although still not
perfect. (For the programmers reading this: I personally find it useful
to think of legalese as source code that runs on the language interpreter of
a given nation's legal system, while the English translations are the code
comments and documentation that anyone should be able to read if they
understand the general concepts involved).&lt;/p&gt;
&lt;p&gt;If at least the second bill passes, then we have another 6 months to work on
a better resolution to the problem.&lt;/p&gt;
&lt;p&gt;If &lt;em&gt;neither&lt;/em&gt; bill passes, then DECO end up in a bad situation where they'll
be required by law to implement and enforce regulations that they're
convinced are a bad idea. They actually have everything in place to do that
if they have to, but they don't want this outcome, and neither does anyone
else.&lt;/p&gt;
&lt;h2&gt;What industry and academia can do about it&lt;/h2&gt;
&lt;p&gt;While it's very short notice, the main thing industry and academia can do
is to file formal submissions with DECO as described in their overview of
the &lt;a href="http://www.defence.gov.au/deco/Consultation.asp"&gt;public consultation process&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;There are three main things to be addressed on that front:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ensuring federal parliament are aware of the importance of amending the
  Defence Trade Controls Act 2012 to eliminate the more draconian provisions&lt;/li&gt;
&lt;li&gt;ensuring federal parliament are aware of the infeasibility of putting this
  into effect on the original timeline and the need for a significant delay
  in the introduction of the enforcement provisions&lt;/li&gt;
&lt;li&gt;ensuring DECO are alerted to any remaining areas of concern in the
  specific drafting of the amended legislation (although I'd advise skipping
  this one if you're not a lawyer yourself - it's the functional equivalent
  of a lawyer with no training as a programmer proposing patches to the Linux
  kernel)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;We were apparently asleep at the wheel when DTCA went through in 2012, so
we owe a &lt;em&gt;lot&lt;/em&gt; of thanks to whoever it was that advocated for and achieved
the inclusion of the two year transition and consultation period in the
original bill. Now we need to help ensure that our currently somewhat
dysfunctional federal parliament doesn't keep us from receiving the benefit
of that foresight.&lt;/p&gt;
&lt;h2&gt;What's definitely not going to happen&lt;/h2&gt;
&lt;p&gt;This consultation process is &lt;em&gt;not&lt;/em&gt; the place to rail against the details of
the Wassenaar Arrangement or Australia's participation in it. You won't
achieve anything except to waste the time of folks that currently have a
really serious problem to fix, and a very limited window in which to fix it.&lt;/p&gt;
&lt;p&gt;Yes, Wassenaar has some serious problems, especially around its handling
of cryptography and cryptographic research, but we have a fairly settled
approach to handling that at this point in history. The critical concern in
this current case is to help DECO ensure that the associated Australian
regulations can be readily handled through the mechanisms that have already
been put in place to handle existing Wassenaar enforcement regimes in other
countries. With the way the 2012 Act was drafted, that's almost certainly
currently not the case, but the proposed 2015 amendments &lt;em&gt;should&lt;/em&gt; fix it
(assuming the amendments actually have the effects that DECO has indicated
they're intended to).&lt;/p&gt;&lt;/div&gt;</description><category>politics</category><category>python</category><category>tech</category><guid>http://www.curiousefficiency.org/posts/2015/01/dtca-public-consultation.html</guid><pubDate>Tue, 20 Jan 2015 12:41:51 GMT</pubDate></item></channel></rss>