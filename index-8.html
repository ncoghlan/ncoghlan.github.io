<!DOCTYPE html>
<html prefix="og: http://ogp.me/ns# article: http://ogp.me/ns/article# " lang="en">
<head>
<meta charset="utf-8">
<base href="http://www.curiousefficiency.org/index-8.html">
<meta name="description" content="Efficiency (a virtue) is the child of laziness and greed (both vices), while
much of our economic activity is devoted to preventing boredom in the idle
time created by increases in efficiency. To be human is to be a strange
creature indeed :)
">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Curious Efficiency (old posts, page 8) | Curious Efficiency</title>
<link href="assets/css/all-nocdn.css" rel="stylesheet" type="text/css">
<meta content="#5670d4" name="theme-color">
<link rel="alternate" type="application/rss+xml" title="RSS" href="rss.xml">
<link rel="canonical" href="http://www.curiousefficiency.org/index-8.html">
<link rel="prev" href="index.html" type="text/html">
<link rel="next" href="index-7.html" type="text/html">
<!--[if lt IE 9]><script src="assets/js/html5.js"></script><![endif]-->
</head>
<body>
<a href="#content" class="sr-only sr-only-focusable">Skip to main content</a>

<!-- Menubar -->

<nav class="navbar navbar-inverse navbar-static-top"><div class="container">
<!-- This keeps the margins nice -->
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-navbar" aria-controls="bs-navbar" aria-expanded="false">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="http://www.curiousefficiency.org/">

                <span id="blog-title">Curious Efficiency</span>
            </a>
        </div>
<!-- /.navbar-header -->
        <div class="collapse navbar-collapse" id="bs-navbar" aria-expanded="false">
            <ul class="nav navbar-nav">
<li>
<a href="pages/about.html">About</a>
                </li>
<li>
<a href="archive.html">Archives</a>
                </li>
<li>
<a href="categories/index.html">Tags</a>
                </li>
<li>
<a href="rss.xml">RSS</a>
                </li>
<li>
<a href="http://python-notes.curiousefficiency.org">Python Notes</a>

                
            </li>
</ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!-- /.navbar-collapse -->
    </div>
<!-- /.container -->
</nav><!-- End of Menubar --><div class="container" id="content" role="main">
    <div class="body-content">
        <!--Body content-->
        <div class="row">
            
            

<div class="postindex">
    <article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/2015/01/dtca-public-consultation.html" class="u-url">DTCA Public Consultation - Brisbane</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">
                Nick Coghlan
            </span></p>
            <p class="dateline"><a href="posts/2015/01/dtca-public-consultation.html" rel="bookmark"><time class="published dt-published" datetime="2015-01-20T12:41:51Z" title="2015-01-20 12:41">2015-01-20 12:41</time></a></p>
                <p class="commentline">
        
    <a href="posts/2015/01/dtca-public-consultation.html#disqus_thread" data-disqus-identifier="cache/posts/2015/01/dtca-public-consultation.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<p>Over the weekend, Asher Wolf
<a href="https://twitter.com/Asher_Wolf/status/555909774596784129">alerted me</a> (and
many others in the open source and cryptographic communities) to the
Australian Defence Trade Controls Act 2012, and the current public
consultation taking place around a bill proposing amendments to that act.</p>
<p>Being heavily involved in improving the security of open source
infrastructure like the <a href="https://pypi.python.org/">Python Package Index</a>
and the
<a href="https://www.python.org/dev/peps/pep-0466/">Python 2 reference interpreter</a>,
working at a multinational open source vendor, and having an extensive
background in working under the constraints of the US International Traffic
in Arms regulations, Asher's concern caught my attention, since bad
legislation in this area can have significant chilling effects on legitimate
research and development activities.</p>
<p>As a result, I've escalated this legislation for review by the legal teams
at various open source companies and organisations, with a view to making
formal submissions to the
<a href="http://www.defence.gov.au/deco/Consultation.asp">public consultation process</a>
that is open until January 30th (ready for bills to be submitted for
consideration to federal parliament on February 23rd).</p>
<p>However, I was also able to attend the first public consultation session
held at the University of Queensland on January 19, so these are my
impressions based primarily on that sessions and my own experiences dealing
with ITAR. I'm not a lawyer and I haven't actually <em>read</em> the legislation,
so I'm not going to pick up on any drafting errors, but I can at least speak
to the intent of the folks involved in moving this process forward.</p>
<h2>What <em>not</em> to worry about</h2>
<p>To folks encountering this kind of legislation for the first time, the
sheer scope of the
<a href="http://www.defence.gov.au/deco/DSGL.asp">Defence and Strategic Goods List</a>
can seem absolutely terrifying. This was very clear to me from some of the
questions various academics in the room were asking.</p>
<p>On this particular point, I can only say: <em>"Don't panic"</em>. This isn't a
unique-to-Australia list, it's backed by a treaty called the
<a href="http://www.wassenaar.org/">Wassenaar Arrangement</a> - the DSGL represents
part of the implementation of that arrangement into Australian law.</p>
<p>When the laws implementing that arrangement are well drafted, everyone outside
the military industrial complex (and certain easily weaponised areas of
scientific research) can pretty much ignore them, while everyone
inside the military industrial complex (and the affected areas of research)
pays very close attention to them because we like not being in jail (and
because gunrunning is bad, and bioterrorism is worse, mmm'kay?).</p>
<p>A heavily regulated military supply chain is already scary enough, we <em>really</em>
don't want to see the likely consequences of an unregulated one. (And if
you're tempted to make a snarky comment about the latter already being the
case, no, it really isn't. While folks can sometimes use overclassification
to avoid regulations they're supposed to be following, that still introduces
significant friction and inefficiencies into whatever they're doing. It's not
as good as people actually respecting the laws of the countries they're
supposedly defending, including genuinely meeting the requirement for
civilian authority over the military, but it's still a hell of a lot better
than nothing).</p>
<p>Getting back on topic, the US ITAR and crypto export control laws are
currently considered the most strict implementation of the Wassenaar
Arrangement amongst the participating nations (going beyond the requirements
of the treaty in several areas), so if you see plenty of US nationals
participating in an activity without being fined and going to jail, you can
be fairly confident that it isn't actually a controlled activity under the
DSGL (or, even if it is, permits for that specific activity will be fairly
easy to get, and the most likely consequence of not realising you need a
permit for something you're doing will be someone from your government
getting in touch to point out that you should apply for one).</p>
<p>There are certainly some very questionable aspects of this list (with the
perennial "favourite" being the fact the Wassenaar Arrangement does, in fact,
attempt to regulate the global trade in mathematics, which is just as stupid
and problematic as it sounds), but it's a known quantity, and one we're pretty
sure we can continue to live with (at least for the time being).</p>
<h2>What to worry about</h2>
<p>The real problem here is that the regulations included in the 2012 Act are
<em>not</em> well drafted, and the legislated 2 year transition period from May 2013
through to May 2015 prior to the enforcement provisions kicking in is about
to run out.</p>
<p>The biggest problem with the 2012 act is that in trying to keep things simple
(essentially, "if its on the DSGL, you need a permit"), it ended up becoming
extraordinarily draconian, requiring a permit for things that don't require
an export license even under ITAR.</p>
<p>For the general public, the most significant shift in the 2015 amendment bill
is the fact that several cases around open publication of information related
to dual-use technologies shift to being allowed by default, and only in
exceptional cases would a permit be required (and in those cases, the onus
would be on the government to inform the covered individuals of that
requirement).</p>
<p>The amendments also include a variety of additional exemptions for little
things like making it legal for Australian's own police and security agencies
to collaborate with their international counterparts. (Snarky comment
opportunity #2: in certain areas, making such collaboration illegal seems
like a potentially attractive idea...)</p>
<p>That 2 year pilot was included in the original legislation as a safety
mechanism, the feedback from the associated steering group has been
extensive, and if things had gone according to plan, the relevant amendments
to the bill would have been passed last year in the spring sitting of federal
parliament, leaving DECO with at least 6 months to educate affected
organisations and individuals, and start issuing the now necessary permits
before the enforcement provisions became active in May. Unfortunately, we
currently have a federal government that views pushing a particular
ideological agenda as being more important than <em>actually doing their job</em>,
so we're now faced with the prospect of regulations that industry doesn't
want, academia doesn't want, the Australian public service don't want, and
the Australian military don't want, coming into effect anyway.</p>
<p>Isn't politics fun?</p>
<h2>What DECO are (trying) to do about it</h2>
<p>The group tasked with untangling this particular legislative Charlie Foxtrot
is the Australian Defence Export Control Office (DECO). Their proposal for
addressing the situation hinges on two bills that they plan to put before
the next sitting of federal parliament:</p>
<ul>
<li>an amendment bill for the Act itself, which fixes it to be a conventional
  implementation of the Wassenaar Arrangement, in line with existing
  implementations in other Wassenaar nations (why we didn't just do that in
  the first place is beyond me, but at least DECO are trying to fix the
  mistake now)</li>
<li>a second bill to delay the enactment of the enforcement provisions for
  a further six months to provide sufficient time for DECO to properly
  educate affected parties and start issuing permits</li>
</ul>
<p>As far as I am aware, the second bill is needed primarily due to the
consideration of the first bill slipping by six months, since we're now
looking at the prospect of only having 4 weeks for DECO to start issuing
permits before the enforcement provisions come into effect. <em>Nobody</em> involved
thinks that's a good idea.</p>
<p>If both of those bills pass promptly, then the only cause for concern is
whether or not there are any remaining devils in the details of the
legislation itself. Member of the general public aren't going to be able to
pick those up - despite the surface similarities, legalese isn't English, and
reading it without interpreting it in the context of relevant case law can be
a good way to get yourself into trouble. Summary translations from legalese
to English by a competent lawyer are a much safer bet, although still not
perfect. (For the programmers reading this: I personally find it useful
to think of legalese as source code that runs on the language interpreter of
a given nation's legal system, while the English translations are the code
comments and documentation that anyone should be able to read if they
understand the general concepts involved).</p>
<p>If at least the second bill passes, then we have another 6 months to work on
a better resolution to the problem.</p>
<p>If <em>neither</em> bill passes, then DECO end up in a bad situation where they'll
be required by law to implement and enforce regulations that they're
convinced are a bad idea. They actually have everything in place to do that
if they have to, but they don't want this outcome, and neither does anyone
else.</p>
<h2>What industry and academia can do about it</h2>
<p>While it's very short notice, the main thing industry and academia can do
is to file formal submissions with DECO as described in their overview of
the <a href="http://www.defence.gov.au/deco/Consultation.asp">public consultation process</a>.</p>
<p>There are three main things to be addressed on that front:</p>
<ul>
<li>ensuring federal parliament are aware of the importance of amending the
  Defence Trade Controls Act 2012 to eliminate the more draconian provisions</li>
<li>ensuring federal parliament are aware of the infeasibility of putting this
  into effect on the original timeline and the need for a significant delay
  in the introduction of the enforcement provisions</li>
<li>ensuring DECO are alerted to any remaining areas of concern in the
  specific drafting of the amended legislation (although I'd advise skipping
  this one if you're not a lawyer yourself - it's the functional equivalent
  of a lawyer with no training as a programmer proposing patches to the Linux
  kernel)</li>
</ul>
<p>We were apparently asleep at the wheel when DTCA went through in 2012, so
we owe a <em>lot</em> of thanks to whoever it was that advocated for and achieved
the inclusion of the two year transition and consultation period in the
original bill. Now we need to help ensure that our currently somewhat
dysfunctional federal parliament doesn't keep us from receiving the benefit
of that foresight.</p>
<h2>What's definitely not going to happen</h2>
<p>This consultation process is <em>not</em> the place to rail against the details of
the Wassenaar Arrangement or Australia's participation in it. You won't
achieve anything except to waste the time of folks that currently have a
really serious problem to fix, and a very limited window in which to fix it.</p>
<p>Yes, Wassenaar has some serious problems, especially around its handling
of cryptography and cryptographic research, but we have a fairly settled
approach to handling that at this point in history. The critical concern in
this current case is to help DECO ensure that the associated Australian
regulations can be readily handled through the mechanisms that have already
been put in place to handle existing Wassenaar enforcement regimes in other
countries. With the way the 2012 Act was drafted, that's almost certainly
currently not the case, but the proposed 2015 amendments <em>should</em> fix it
(assuming the amendments actually have the effects that DECO has indicated
they're intended to).</p>
</div>
    </div>
    </article><article class="h-entry post-text"><header><h1 class="p-name entry-title"><a href="posts/2014/12/kallithea-on-openshift.html" class="u-url">Running Kallithea on OpenShift</a></h1>
        <div class="metadata">
            <p class="byline author vcard"><span class="byline-name fn">
                Nick Coghlan
            </span></p>
            <p class="dateline"><a href="posts/2014/12/kallithea-on-openshift.html" rel="bookmark"><time class="published dt-published" datetime="2014-12-11T03:18:26Z" title="2014-12-11 03:18">2014-12-11 03:18</time></a></p>
                <p class="commentline">
        
    <a href="posts/2014/12/kallithea-on-openshift.html#disqus_thread" data-disqus-identifier="cache/posts/2014/12/kallithea-on-openshift.html">Comments</a>


        </p>
</div>
    </header><div class="e-content entry-content">
    <div>
<h2>Kallithea for CPython</h2>
<p>The CPython core development team are currently evaluating our options for
modernising our core development workflows to better match the standards
set by other projects and services like OpenStack and GitHub.</p>
<p>The first step in <a href="https://www.python.org/dev/peps/pep-0474/">my own proposal</a>
for that is to migrate a number of the support repositories currently hosted
using a basic Mercurial server on hg.python.org to an instance of
<a href="https://kallithea-scm.org/">Kallithea</a> hosted as forge.python.org.
(Kallithea is a GPLv3 Python project that was forked from RhodeCode after
certain aspects of the latter's commercialisation efforts started alienating
several members of their user and developer community)</p>
<p>Tymoteusz Jankowski (a contributor to Allegro Group's open source data centre
inventory management system, <a href="http://ralph.allegrogroup.com/">Ralph</a>), has
already started looking at the steps that might be involved in integrating a
Kallithea instance into the PSF's Salt based
<a href="https://github.com/xliiv/psf-salt/tree/kallithea">infrastructure automation</a>.</p>
<p>However, for my proposal to be as successful as I would like it to be, I need
the barriers to entry for the development and deployment of the upstream
Kallithea project itself to be as low as possible. One of the challenges
we've often had with gaining contributors to CPython infrastructure
maintenance is the relatively high barriers to entry for trying out service
changes and sharing them with others, so this time I plan to tackle that
concern <em>first</em>, by ensuring that addressing it is a mandatory requirement
in my proposal.</p>
<p>That means tackling two particular problems:</p>
<ul>
<li>Having a way to easily run local test instances for development and
  experimentation</li>
<li>Having a way to easily share demonstration instances with others</li>
</ul>
<p>For the first problem, I plan to rely on Vagrant and Docker, while for the
second I'll be relying on the free tier in Red Hat's OpenShift Online
service. Unfortunately, while the
<a href="http://www.openshift.org/">next generation</a> of OpenShift will support Docker
images natively, for the time being, I need to tackle these as two separate
problems, as there aren't any existing Docker based services I'm aware of
with a free tier that is similarly suited to the task of sharing development
prototypes for open source web services with a broad audience (let alone
any such services that are also
<a href="https://github.com/openshift">fully open source</a>).</p>
<p>Once I have these working to my satisfaction, I'll propose them to the
Kallithea team for inclusion in the Kallithea developer documentation, but
in the meantime I'll just document them here on the blog.</p>
<h2>Enabling Kallithea deployment on OpenShift</h2>
<p>My first priority is to get a public demonstration instance up and running
that I can start tweaking towards the CPython core development community's
needs (e.g. installing the custom repo hooks we run on hg.python.org), so
I'm starting by figuring out the OpenShift setup needed to run public
instances - the Vagrant/Docker based setup for local development will come
later.</p>
<p>Conveniently, WorldLine previously created an <a href="https://github.com/worldline/openshift-rhodecode">OpenShift quickstart for
RhodeCode</a> and published
it under the Apache License 2.0, so I was able to use that as a starting
point for my own
<a href="https://github.com/ncoghlan/openshift-kallithea">Kallithea quickstart</a>.</p>
<p>While I personally prefer to run Python web services under mod_wsgi in order
to take advantage of Apache's authentication &amp; authorisation plugin ecosystem,
that's not a significant concern for the demonstration server use case I have
in mind here. There are also some other aspects in the WorldLine quickstart
I'd like to understand better and potentially change (like figuring out a
better way of installing git that doesn't involve hardcoding a particular
version), but again, not a big deal for demonstration instances - rather
than worrying about them too much, I just annotated them as <code>TODO</code> comments
in the OpenShift hook source code.</p>
<p>I'd also prefer to be running under the official Python 2.7 cartridge rather
than a DIY cartridge, but again, my focus at this point is on getting
something up and running, and then iterating from there to improve it.</p>
<p>That meant adapting the quickstart from RhodeCode to Kallithea was mostly
just a matter of changing the names of the various components being installed
and invoked, together with changing the actual installation and upgrade steps
to be based on Kallithea's deployment instructions.</p>
<p>The keys to this are the
<a href="https://github.com/ncoghlan/openshift-kallithea/blob/master/.openshift/action_hooks/build">build hook</a>
and the
<a href="https://github.com/ncoghlan/openshift-kallithea/blob/master/.openshift/action_hooks/start">start hook</a>.
The <a href="https://developers.openshift.com/en/managing-action-hooks.html">OpenShift docs</a>
have more details on the various available action hooks and when they're run.</p>
<p>In addition to the <code>TODO</code> comments noted above, I also added various comments
explaining <em>what</em> different parts of the action hook scripts were doing.</p>
<p>(Note: I haven't actually <em>tested</em> an upgrade, only the initial
deployment described below, so I can't be sure I have actually adapted the
upgrade handling correctly yet)</p>
<h2>Deploying my own Kallithea instance</h2>
<p>I already have an OpenShift account, so I could
<a href="https://www.openshift.com/app/account/new">skip that step</a>, and just
create a new app under my existing account. However, I didn't have the command
line tools installed, so that was the first step in creating my own instance:</p>
<pre class="code literal-block">sudo yum install /usr/bin/rhc
</pre>


<p>yum is able to figure out on my behalf that it is <code>rubygems-rhc</code> that
provides the command line tools for OpenShift in Fedora (alternatively,
I could have looked that up myself in the
<a href="https://developers.openshift.com/en/getting-started-client-tools.html#fedora">OpenShift client tools installation docs</a>).</p>
<p>The next step was to configure the command line tools to use my OpenShift
Online account, generate a local login token for this machine, and upload
my public SSH key to OpenShift Online. That process involved working through
the interactive prompts in:</p>
<pre class="code literal-block">rhc setup
</pre>


<p>With those preliminary OpenShift steps out of the way, it was time to
move on to deploying the application itself. It's worth noting that
app creation automatically clones a local git repo named after the application,
so I created a separate "app_repos" subdirectory in my development directory
specifically so I could call my OpenShift app "kallithea" without conflicting
with my local clone of the main kallithea repo.</p>
<p>As described in the quickstart README, the app creation command is:</p>
<pre class="code literal-block">rhc app create kallithea diy-0.1 postgresql-9.2
</pre>


<p>That churned away for a while, and then attempted to clone the app repo
locally over ssh (with SSH putting up a prompt to accept the validity of the
app's freshly generated SSH key). I'm not sure why, but for some reason that
automatic clone operation didn't work for me. <code>rhc</code> put up a detailed
message explaining that the app creation had worked, but the clone step had
failed. Fortunately, as the troubleshooting notice suggested, a subsequent
<code>rhc git-clone kallithea</code> worked as expected.</p>
<p>OpenShift provides a default app skeleton automatically, but I actually
want to get rid of that and replace it with the contents of the quickstart
repo:</p>
<pre class="code literal-block">rm -R diy .openshift misc README.md
git add .
git commit -m "Remove template files"
git remote add quickstart -m master https://github.com/ncoghlan/openshift-kallithea.git
git pull -s recursive -X theirs quickstart master
</pre>


<p>The default merge commit message that popped up was fine, so I just accepted
that and moved on to the most interesting step:</p>
<pre class="code literal-block">git push
</pre>


<p>Because this is the first build, there's a lot of output related to
installing and building the PostgreSQL driver and git, before moving on
to installing Kallithea and its dependencies.</p>
<p>However, that still didn't take long, and completed without errors, so I now
have my own Kallithea instance
<a href="http://kallithea-ncoghlan.rhcloud.com/">up and running</a>.</p>
<p>And no, the default admin credentials created by the quickstart won't work
anymore - I immediately logged in to the admin account to change them!</p>
<h2>Where to from here?</h2>
<p>There are various aspects of the current quickstart that are far from ideal,
but I don't plan to spend a lot of time worrying about it when I know that
support for using Docker images directly in OpenShift is coming at some
point in the not too distant future.</p>
<p>One of the key advantages of Docker is the much nicer approach it offers to
layered application development where infrastructure experts can provide
base images for others to build on, and in the case of deploying Python
applications with mod_wsgi, that means listening to Graham Dumpleton (the
author of mod_wsgi, currently working for New Relic).</p>
<p>On that front, Graham has actually been
<a href="http://blog.dscpl.com.au/2014/12/hosting-python-wsgi-applications-using.html">working on</a>
creating a set of Debian based
<a href="https://registry.hub.docker.com/u/grahamdumpleton/mod-wsgi-docker/">mod_wsgi Docker images</a>
that Python developers can use, rather than having to build their own from
scratch.</p>
<p>In my case, I'd really prefer something based on CentOS 7 or Fedora Cloud,
but that's a relatively minor quibble, and Graham's images should still make
a great basis for putting together a Vagrant+Docker based local workflow
for folks working on Kallithea.</p>
<p>That, however, is a topic for a future post :)</p>
</div>
    </div>
    </article>
</div>

        <nav class="postindexpager"><ul class="pager">
<li class="previous">
                <a href="index.html" rel="prev">Newer posts</a>
            </li>
            <li class="next">
                <a href="index-7.html" rel="next">Older posts</a>
            </li>
        </ul></nav><script>var disqus_shortname="boredomandlaziness";(function(){var a=document.createElement("script");a.async=true;a.src="//"+disqus_shortname+".disqus.com/count.js";(document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]).appendChild(a)}());</script>
</div>
        <!--End of body content-->

        <footer id="footer">
            Contents Â© 2016 <a href="mailto:ncoghlan@gmail.com">Nick Coghlan</a> - <a href="https://creativecommons.org/publicdomain/zero/1.0/">CC0</a>, republish as you wish. - Powered by <a href="http://nikola.ralsina.com.ar">Nikola</a>
            
        </footer>
</div>
</div>


            <script src="assets/js/all-nocdn.js"></script><script>$('a.image-reference:not(.islink) img:not(.islink)').parent().colorbox({rel:"gal",maxWidth:"100%",maxHeight:"100%",scalePhotos:true});</script><!-- fancy dates --><script>
    moment.locale("");
    fancydates(0, "YYYY-MM-DD HH:mm");
    </script><!-- end fancy dates -->
</body>
</html>
